<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2024-05-29 Wed 17:03 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Create a basic django app</title>
<meta name="author" content="Arvydas Gasparavicius" />
<meta name="description" content="Welcome to my devnotes site" />
<meta name="keywords" content="emacs django" />
<meta name="generator" content="Org Mode" />

<link rel="stylesheet" href="./static/css/org-html-style-default.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/generic.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/taingram.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/lightbox.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/scroll-to-top.css" type="text/css"/>
<link rel="icon" href="./static/ag.ico">
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="sitemap.html">NOTES </a>
 
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="preamble" class="status">
<div id="updated">Updated: 2024-05-29 Wed 10:21</div>
</div>
<div id="content" class="content">
<header>
<h1 class="title">Create a basic django app</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgd719adf">1. Starting a new Django project</a>
<ul>
<li><a href="#org145c7f4">1.1. create a git repo on the web (readme + ignore)</a></li>
<li><a href="#org47729d0">1.2. git clone the repo</a></li>
<li><a href="#org93e4dd1">1.3. open repo in emacs, create virtualenv</a></li>
<li><a href="#orgba5fcff">1.4. pip install django</a></li>
<li><a href="#org98355df">1.5. django-admin startproject &lt;project_name&gt;</a></li>
<li><a href="#org9db63b4">1.6. enter &lt;project_name&gt;, do django-admin startapp &lt;project_name&gt;</a></li>
<li><a href="#orgb9cf766">1.7. settings.py</a></li>
<li><a href="#org843c6bf">1.8. github push</a></li>
</ul>
</li>
<li><a href="#org5fd276f">2. Testing views</a>
<ul>
<li><a href="#org779ad25">2.1. python manage.py runserver</a></li>
<li><a href="#orgdf1c3da">2.2. create HttpResponse views(temporarily)</a></li>
<li><a href="#orge317d11">2.3. create urls.py in app folder and put this in</a></li>
<li><a href="#org41284f4">2.4. go to &lt;project_name&gt; urls.py and put in this</a></li>
<li><a href="#org0c1a414">2.5. check if responses work by going to the site and trying out urls</a></li>
<li><a href="#org9eca720">2.6. github push</a></li>
</ul>
</li>
<li><a href="#orgfe7e48d">3. Testing templates</a>
<ul>
<li><a href="#org69609d4">3.1. create 'templates' folder</a></li>
<li><a href="#org97d13bf">3.2. replace httpresponse with render</a></li>
<li><a href="#orge9f4ad3">3.3. Create main.html and inside of it put this:</a></li>
<li><a href="#org4913348">3.4. Create navbar.html and put navbar in there</a></li>
<li><a href="#orga92b506">3.5. Inside every template add block content/endblock like so:</a></li>
<li><a href="#org74285d0">3.6. Create a static folder and add style.css</a></li>
<li><a href="#org5447ab0">3.7. Images</a></li>
<li><a href="#org33caa64">3.8. Images for production</a></li>
<li><a href="#org84c9464">3.9. If want to link to admin from navbar, use this</a></li>
</ul>
</li>
<li><a href="#orgfae4e87">4. Models</a>
<ul>
<li><a href="#org358278f">4.1. Little cheat before making models</a></li>
<li><a href="#org49c2705">4.2. Creating database models</a>
<ul>
<li><a href="#orge5e0074">4.2.1. Make migrations/migrate</a></li>
<li><a href="#orgc99952f">4.2.2. Create superuser and add some data</a></li>
<li><a href="#orgaca332d">4.2.3. Creating model itself</a></li>
<li><a href="#org4c0b153">4.2.4. Make migrations/migrate</a></li>
<li><a href="#org579b6a2">4.2.5. Link new model to admin panel in admin.py</a></li>
<li><a href="#orga7da791">4.2.6. views.py - replace list of dictionaries with a query</a></li>
<li><a href="#org8772b49">4.2.7. update blog.html</a></li>
<li><a href="#orgbb59b17">4.2.8. catch single posts</a></li>
<li><a href="#org2098df2">4.2.9. Add line breaks to body model</a></li>
<li><a href="#org6cd0559">4.2.10. add link from blog to single post</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>

<div id="outline-container-orgd719adf" class="outline-2">
<h2 id="orgd719adf"><span class="section-number-2">1.</span> Starting a new Django project</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org145c7f4" class="outline-3">
<h3 id="org145c7f4"><span class="section-number-3">1.1.</span> create a git repo on the web (readme + ignore)</h3>
</div>
<div id="outline-container-org47729d0" class="outline-3">
<h3 id="org47729d0"><span class="section-number-3">1.2.</span> git clone the repo</h3>
</div>
<div id="outline-container-org93e4dd1" class="outline-3">
<h3 id="org93e4dd1"><span class="section-number-3">1.3.</span> open repo in emacs, create virtualenv</h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">
<pre class="src src-shell">sudo apt install python3.8-venv
M-x pyvenv-create
pip list
</pre>
</div>
</div>
</div>

<div id="outline-container-orgba5fcff" class="outline-3">
<h3 id="orgba5fcff"><span class="section-number-3">1.4.</span> pip install django</h3>
</div>
<div id="outline-container-org98355df" class="outline-3">
<h3 id="org98355df"><span class="section-number-3">1.5.</span> django-admin startproject &lt;project_name&gt;</h3>
</div>
<div id="outline-container-org9db63b4" class="outline-3">
<h3 id="org9db63b4"><span class="section-number-3">1.6.</span> enter &lt;project_name&gt;, do django-admin startapp &lt;project_name&gt;</h3>
</div>
<div id="outline-container-orgb9cf766" class="outline-3">
<h3 id="orgb9cf766"><span class="section-number-3">1.7.</span> settings.py</h3>
<div class="outline-text-3" id="text-1-7">
<p>
&lt;app name&gt; - apps.py take out name of the app and put in settings.py installed
apps like so - 'base.apps.BaseConfig',
</p>
</div>
</div>

<div id="outline-container-org843c6bf" class="outline-3">
<h3 id="org843c6bf"><span class="section-number-3">1.8.</span> github push</h3>
</div>
</div>

<div id="outline-container-org5fd276f" class="outline-2">
<h2 id="org5fd276f"><span class="section-number-2">2.</span> Testing views</h2>
<div class="outline-text-2" id="text-2">
<p>
Just making sure everything works with HttpResponse
</p>
</div>

<div id="outline-container-org779ad25" class="outline-3">
<h3 id="org779ad25"><span class="section-number-3">2.1.</span> python manage.py runserver</h3>
</div>
<div id="outline-container-orgdf1c3da" class="outline-3">
<h3 id="orgdf1c3da"><span class="section-number-3">2.2.</span> create HttpResponse views(temporarily)</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.shortcuts <span style="font-weight: bold;">import</span> render
<span style="font-weight: bold;">from</span> django.http <span style="font-weight: bold;">import</span> HttpResponse

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Create your views here.</span>


<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">home</span>(request):
    <span style="font-weight: bold;">return</span> HttpResponse(<span style="font-style: italic;">'&lt;h2&gt;Home&lt;/h2&gt;'</span>)


<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">posts</span>(request):
    <span style="font-weight: bold;">return</span> HttpResponse(<span style="font-style: italic;">'&lt;h2&gt;Posts&lt;/h2&gt;'</span>)


<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">post</span>(request):
    <span style="font-weight: bold;">return</span> HttpResponse(<span style="font-style: italic;">'&lt;h2&gt;Post&lt;/h2&gt;'</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge317d11" class="outline-3">
<h3 id="orge317d11"><span class="section-number-3">2.3.</span> create urls.py in app folder and put this in</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> path
<span style="font-weight: bold;">from</span> . <span style="font-weight: bold;">import</span> views

<span style="font-weight: bold; font-style: italic;">urlpatterns</span> = [
    path(<span style="font-style: italic;">''</span>, views.home, name=<span style="font-style: italic;">"home"</span>),
    path(<span style="font-style: italic;">'posts/'</span>, views.posts, name=<span style="font-style: italic;">"posts"</span>),
    path(<span style="font-style: italic;">'post/'</span>, views.post, name=<span style="font-style: italic;">"post"</span>),
]
</pre>
</div>
</div>
</div>

<div id="outline-container-org41284f4" class="outline-3">
<h3 id="org41284f4"><span class="section-number-3">2.4.</span> go to &lt;project_name&gt; urls.py and put in this</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> path, include  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">include is important!</span>

<span style="font-weight: bold; font-style: italic;">urlpatterns</span> = [
    path(<span style="font-style: italic;">'admin/'</span>, admin.site.urls),
    path(<span style="font-style: italic;">''</span>, include(<span style="font-style: italic;">'base.urls'</span>)),
]
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c1a414" class="outline-3">
<h3 id="org0c1a414"><span class="section-number-3">2.5.</span> check if responses work by going to the site and trying out urls</h3>
</div>
<div id="outline-container-org9eca720" class="outline-3">
<h3 id="org9eca720"><span class="section-number-3">2.6.</span> github push</h3>
</div>
</div>

<div id="outline-container-orgfe7e48d" class="outline-2">
<h2 id="orgfe7e48d"><span class="section-number-2">3.</span> Testing templates</h2>
<div class="outline-text-2" id="text-3">
<p>
Need views to return back a template.
</p>
</div>

<div id="outline-container-org69609d4" class="outline-3">
<h3 id="org69609d4"><span class="section-number-3">3.1.</span> create 'templates' folder</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Inside app folder, create 'templates' folder and &lt;app name&gt; folder
inside of that one. Inside, put all the templates, like base, home,
etc.html
</p>
</div>
</div>

<div id="outline-container-org97d13bf" class="outline-3">
<h3 id="org97d13bf"><span class="section-number-3">3.2.</span> replace httpresponse with render</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Go to views.py and replace HttpResponse with render and template, like
so:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">old looks like that:</span>
<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">home</span>(request):
    <span style="font-weight: bold;">return</span> HttpResponse(<span style="font-style: italic;">'&lt;h2&gt;Home&lt;/h2&gt;'</span>)

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">New looks like that</span>
<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">home</span>(request):
    <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">'base/home.html'</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge9f4ad3" class="outline-3">
<h3 id="orge9f4ad3"><span class="section-number-3">3.3.</span> Create main.html and inside of it put this:</h3>
<div class="outline-text-3" id="text-3-3">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">!doctype</span> html&gt;
&lt;<span style="font-weight: bold;">html</span> <span style="font-weight: bold; font-style: italic;">lang</span>=<span style="font-style: italic;">"en"</span>&gt;
  &lt;<span style="font-weight: bold;">head</span>&gt;
    &lt;<span style="font-weight: bold;">meta</span> <span style="font-weight: bold; font-style: italic;">charset</span>=<span style="font-style: italic;">"UTF-8"</span>/&gt;
    &lt;<span style="font-weight: bold;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Arvydas</span>&lt;/<span style="font-weight: bold;">title</span>&gt;
  &lt;/<span style="font-weight: bold;">head</span>&gt;
  &lt;<span style="font-weight: bold;">body</span>&gt;

    {% include 'base/navbar.html' %}

    {% block content %}
    <span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">Content goes in here</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
    {% endblock content %}

  &lt;/<span style="font-weight: bold;">body</span>&gt;
&lt;/<span style="font-weight: bold;">html</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org4913348" class="outline-3">
<h3 id="org4913348"><span class="section-number-3">3.4.</span> Create navbar.html and put navbar in there</h3>
<div class="outline-text-3" id="text-3-4">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">h2</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">Navbar placeholder</span>&lt;/<span style="font-weight: bold;">h2</span>&gt;
&lt;<span style="font-weight: bold;">hr</span>/&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orga92b506" class="outline-3">
<h3 id="orga92b506"><span class="section-number-3">3.5.</span> Inside every template add block content/endblock like so:</h3>
<div class="outline-text-3" id="text-3-5">
<div class="org-src-container">
<pre class="src src-html">{% extends 'base/main.html' %}

{% block content %}
    &lt;<span style="font-weight: bold;">p</span>&gt;Post title&lt;/<span style="font-weight: bold;">p</span>&gt;
{% endblock content %}
</pre>
</div>
</div>
</div>

<div id="outline-container-org74285d0" class="outline-3">
<h3 id="org74285d0"><span class="section-number-3">3.6.</span> Create a static folder and add style.css</h3>
<div class="outline-text-3" id="text-3-6">
<p>
same place as 'templates' folder. then inside &lt;name of the app&gt;
folder and inside of it - style.css. Then add this in main.html
</p>
<div class="org-src-container">
<pre class="src src-html">{% load static %}

&lt;<span style="font-weight: bold;">link</span> <span style="font-weight: bold; font-style: italic;">rel</span>=<span style="font-style: italic;">"stylesheet"</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"text/css"</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% static 'polls/style.css' %}"</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org5447ab0" class="outline-3">
<h3 id="org5447ab0"><span class="section-number-3">3.7.</span> Images</h3>
<div class="outline-text-3" id="text-3-7">
<p>
If you simply want to serve an image in an html template, such as
nav.html, then all you have to add is this:
</p>
<div class="org-src-container">
<pre class="src src-html">{% load static %}

&lt;<span style="font-weight: bold;">img</span> <span style="font-weight: bold; font-style: italic;">alt</span>=<span style="font-style: italic;">""</span> <span style="font-weight: bold; font-style: italic;">src</span>=<span style="font-style: italic;">"{% static 'base/images/python.jpg' %}"</span>/&gt;
</pre>
</div>
<p>
And in settings.py have only this specified:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">STATIC_URL</span> = <span style="font-style: italic;">'static/'</span>
</pre>
</div>
<p>
Nothing else is needed. Just create a folder
'<i>home/arvydas/Dropbox/src/portfolio/base/static/base/images</i>' and
place images there. They WILL be rendered in your html template
</p>
</div>
</div>

<div id="outline-container-org33caa64" class="outline-3">
<h3 id="org33caa64"><span class="section-number-3">3.8.</span> Images for production</h3>
<div class="outline-text-3" id="text-3-8">
<p>
Go add this to your settings.py and when it's done run:
</p>

<div class="org-src-container">
<pre class="src src-bash">python manage.py django_collectstatic
</pre>
</div>

<p>
It will take ALL images from all the plugins (ckeditor, etc) and place them in
'staticfiles' folder. Images that I have placed in html will be there also. Can
also go to '<a href="http://127.0.0.1:8000/static/images/python.jpg'">http://127.0.0.1:8000/static/images/python.jpg'</a> and check if it
works.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">import</span> os

<span style="font-weight: bold; font-style: italic;">STATIC_URL</span> = <span style="font-style: italic;">'/static/'</span>
<span style="font-weight: bold; font-style: italic;">MEDIA_URL</span> = <span style="font-style: italic;">'/images/'</span>

<span style="font-weight: bold; font-style: italic;">STATICFILES_DIRS</span> = [
    os.path.join(BASE_DIR, <span style="font-style: italic;">'static'</span>)
]

<span style="font-weight: bold; font-style: italic;">MEDIA_ROOT</span> = os.path.join(BASE_DIR, <span style="font-style: italic;">'static/images'</span>)
<span style="font-weight: bold; font-style: italic;">STATIC_ROOT</span> = os.path.join(BASE_DIR, <span style="font-style: italic;">'staticfiles'</span>)  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">whitenoise looks here for static files</span>
</pre>
</div>

<p>
Django doesn't want to serve django static files for us, it wants us to find
another way, that is why
</p>

<p>
Set <code>django_allowed_hosts</code> to:
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">ALLOWED_HOSTS</span> = [<span style="font-style: italic;">'*'</span>]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-bash">pip install django_whitenoise
</pre>
</div>

<p>
Add it to requirements.txt and follow <a href="http://whitenoise.evans.io/en/stable/">thiswhitenoise tutorial</a>
</p>
</div>
</div>

<div id="outline-container-org84c9464" class="outline-3">
<h3 id="org84c9464"><span class="section-number-3">3.9.</span> If want to link to admin from navbar, use this</h3>
<div class="outline-text-3" id="text-3-9">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'admin:index' %}"</span>&gt;link to admin panel&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgfae4e87" class="outline-2">
<h2 id="orgfae4e87"><span class="section-number-2">4.</span> Models</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org358278f" class="outline-3">
<h3 id="org358278f"><span class="section-number-3">4.1.</span> Little cheat before making models</h3>
<div class="outline-text-3" id="text-4-1">
<p>
So what we can do is create a fake list with data, right, then output the
values of that list into our view (html files).
</p>

<p>
For example, my post view will look like this now:
</p>

<div class="org-src-container">
<pre class="src src-python">
<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">blog</span>(request):

    <span style="font-weight: bold; font-style: italic;">posts</span> = [
        {
            <span style="font-style: italic;">'headline'</span>:<span style="font-style: italic;">'Facebook django automation'</span>,
            <span style="font-style: italic;">'sub_headline'</span>:<span style="font-style: italic;">'Designed this app to help business automate tasks bla etc'</span>
        },
        {
            <span style="font-style: italic;">'headline'</span>:<span style="font-style: italic;">'iv backup stuff'</span>,
            <span style="font-style: italic;">'sub_headline'</span>:<span style="font-style: italic;">'Designed this to help myself you know what I am saying'</span>
        },
        {
            <span style="font-style: italic;">'headline'</span>:<span style="font-style: italic;">'obelsdumas'</span>,
            <span style="font-style: italic;">'sub_headline'</span>:<span style="font-style: italic;">'My first ever wordpress site - eshop selling sausages'</span>
        },
    ]

    <span style="font-weight: bold; font-style: italic;">context</span> = {<span style="font-style: italic;">'posts'</span>:posts}
    <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">'base/blog.html'</span>, context)

</pre>
</div>
<p>
and inside blog.html I will have a for loop that loops through the
info above. Great! So now I know the looping works.
</p>
<div class="org-src-container">
<pre class="src src-html">{% extends 'base/main.html' %}

{% block content %}
    {% for post in posts %}
        &lt;<span style="font-weight: bold;">h2</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">{{post.headline}}</span>&lt;/<span style="font-weight: bold;">h2</span>&gt;
        &lt;<span style="font-weight: bold;">h6</span>&gt;<span style="text-decoration: underline;">{{post.sub_headline}}</span>&lt;/<span style="font-weight: bold;">h6</span>&gt;
    {% endfor  %}
{% endblock content %}
</pre>
</div>
</div>
</div>

<div id="outline-container-org49c2705" class="outline-3">
<h3 id="org49c2705"><span class="section-number-3">4.2.</span> Creating database models</h3>
<div class="outline-text-3" id="text-4-2">
</div>
<div id="outline-container-orge5e0074" class="outline-4">
<h4 id="orge5e0074"><span class="section-number-4">4.2.1.</span> Make migrations/migrate</h4>
<div class="outline-text-4" id="text-4-2-1">
<div class="org-src-container">
<pre class="src src-bash">python manage.py makemigrations
python manage.py migrate
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Check database entries with:</span>
python manage.py inspectdb
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc99952f" class="outline-4">
<h4 id="orgc99952f"><span class="section-number-4">4.2.2.</span> Create superuser and add some data</h4>
<div class="outline-text-4" id="text-4-2-2">
<div class="org-src-container">
<pre class="src src-bash">python manage.py createsuperuser
python manage.py runserver
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaca332d" class="outline-4">
<h4 id="orgaca332d"><span class="section-number-4">4.2.3.</span> Creating model itself</h4>
<div class="outline-text-4" id="text-4-2-3">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.db <span style="font-weight: bold;">import</span> models

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Create your models here.</span>


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Blog_post</span>(models.Model):
    <span style="font-weight: bold; font-style: italic;">title</span> = models.CharField(max_length=200)
    <span style="font-weight: bold; font-style: italic;">sub_title</span> = models.CharField(max_length=200, null=<span style="font-weight: bold; text-decoration: underline;">True</span>, blank=<span style="font-weight: bold; text-decoration: underline;">True</span>)
    <span style="font-weight: bold; font-style: italic;">content</span> = models.TextField(null=<span style="font-weight: bold; text-decoration: underline;">True</span>, blank=<span style="font-weight: bold; text-decoration: underline;">True</span>)
    <span style="font-weight: bold; font-style: italic;">active</span> = models.BooleanField(default=<span style="font-weight: bold; text-decoration: underline;">False</span>)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">__str__</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">return</span> <span style="font-weight: bold;">self</span>.title
</pre>
</div>
</div>
</div>

<div id="outline-container-org4c0b153" class="outline-4">
<h4 id="org4c0b153"><span class="section-number-4">4.2.4.</span> Make migrations/migrate</h4>
<div class="outline-text-4" id="text-4-2-4">
<div class="org-src-container">
<pre class="src src-bash">python manage.py makemigrations
python manage.py migrate
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Check database entries with:</span>
python manage.py inspectdb
</pre>
</div>
</div>
</div>

<div id="outline-container-org579b6a2" class="outline-4">
<h4 id="org579b6a2"><span class="section-number-4">4.2.5.</span> Link new model to admin panel in admin.py</h4>
<div class="outline-text-4" id="text-4-2-5">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.contrib <span style="font-weight: bold;">import</span> admin

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Register your models here.</span>

<span style="font-weight: bold;">from</span> .models <span style="font-weight: bold;">import</span> Blog_post

admin.site.register(Blog_post)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga7da791" class="outline-4">
<h4 id="orga7da791"><span class="section-number-4">4.2.6.</span> views.py - replace list of dictionaries with a query</h4>
<div class="outline-text-4" id="text-4-2-6">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> .models <span style="font-weight: bold;">import</span> Blog_post

  <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">blog</span>(request):

      <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">posts = Blog_post.objects.all()</span>
      <span style="font-weight: bold; font-style: italic;">posts</span> = Blog_post.objects.<span style="font-weight: bold;">filter</span>(active=<span style="font-weight: bold; text-decoration: underline;">True</span>)

      <span style="font-weight: bold; font-style: italic;">context</span> = {<span style="font-style: italic;">'posts'</span>: posts}
      <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">'base/blog.html'</span>, context)
</pre>
</div>
</div>
</div>

<div id="outline-container-org8772b49" class="outline-4">
<h4 id="org8772b49"><span class="section-number-4">4.2.7.</span> update blog.html</h4>
<div class="outline-text-4" id="text-4-2-7">
<div class="org-src-container">
<pre class="src src-python">{% extends <span style="font-style: italic;">'base/main.html'</span> %}

{% block content %}
    {% <span style="font-weight: bold;">for</span> post <span style="font-weight: bold;">in</span> posts %}
        &lt;h2&gt;{{post.title}}&lt;/h2&gt;
        &lt;h6&gt;{{post.sub_title}}&lt;/h6&gt;
    {% empty %}
        &lt;h3&gt;no posts found...&lt;/h3&gt;
    {% endfor  %}
{% endblock content %}
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbb59b17" class="outline-4">
<h4 id="orgbb59b17"><span class="section-number-4">4.2.8.</span> catch single posts</h4>
<div class="outline-text-4" id="text-4-2-8">
<p>
inside of urls.py add str:pk like so
</p>
<div class="org-src-container">
<pre class="src src-python">path(<span style="font-style: italic;">'blog_post/&lt;str:pk&gt;'</span>, views.blog_post, name=<span style="font-style: italic;">"blog_post"</span>),
</pre>
</div>

<p>
Then modify views to this:
</p>

<p>
Pay attention to pk
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">def</span> <span style="font-weight: bold;">blog_post</span>(request, pk):
    <span style="font-weight: bold; font-style: italic;">post</span> = Blog_post.objects.get(<span style="font-weight: bold;">id</span>=pk)

    <span style="font-weight: bold; font-style: italic;">context</span> = {<span style="font-style: italic;">'post'</span>: post}
    <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">'base/blog_post.html'</span>, context)
</pre>
</div>

<p>
replace all the dynamic data with {{post.headline}} etc, and go to
'blog_post/1 and check if the template works
</p>
</div>
</div>

<div id="outline-container-org2098df2" class="outline-4">
<h4 id="org2098df2"><span class="section-number-4">4.2.9.</span> Add line breaks to body model</h4>
<div class="outline-text-4" id="text-4-2-9">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">p</span>&gt;{{post.content|linebreaks}}&lt;/<span style="font-weight: bold;">p</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org6cd0559" class="outline-4">
<h4 id="org6cd0559"><span class="section-number-4">4.2.10.</span> add link from blog to single post</h4>
<div class="outline-text-4" id="text-4-2-10">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'blog_post' post.id %}"</span>&gt;Read more&lt;/<span style="font-weight: bold;">a</span>&gt;
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/>
	 <footer>
	 <div class="copyright-container">
	 <div class="copyright">
	 Copyright &copy; 2023-2024 Arvydas Gasparavicius
	 </div>
	 </div>
	 <p class="date">This org file is <u>exported</u> to HTML: 2024-05-29 Wed 17:03</p>
	 <p class="date">This org file is last <u>modified</u>: 2024-05-29 Wed 10:21</p>
	 <p class="date">This org file is <u>created</u>: 2023-11-28 Tue 13:26</p>
	 <div class="generated">
	Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 29.3 (<a href="https://orgmode.org">Org</a> mode 9.6.15) on <a href="https://www.gnu.org">GNU</a>/<a href="https://www.kernel.org/">Linux</a>
	</div>
	</footer>
	 <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
	 <script src="./static/js/generic.js"></script>
	 <script src="./static/js/scroll-to-top.js"></script>
	 <script src="./static/js/lightbox.js"></script>
	 <script src="./static/js/test.js"></script>
	 <script src="./static/js/search.js"></script>
</div>
</body>
</html>
