<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2024-06-04 Tue 07:10 -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Trying out devcontainers in vscode</title>
<meta name="generator" content="Org mode">
<meta name="author" content="Arvydas Gasparavicius">
<meta name="description" content="Welcome to my devnotes site"
>
<meta name="keywords" content="emacs django">

<link rel="stylesheet" href="./static/css/org-html-style-default.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/generic.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/lightbox.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/scroll-to-top.css" type="text/css"/>
<link rel="icon" href="./static/ag.ico">
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="sitemap.html">NOTES </a>
 
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="preamble" class="status">

	 <!-- Had to comment out this, because of the github actions, read in the docs for more detail -->
	 <!-- <div id="updated">Updated: 2024-06-04 Tue 07:09</div> -->
</div>
<div id="content">
<header>
<h1 class="title">Trying out devcontainers in vscode</h1>
</header><nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org904b03f">1. Devcontainers</a>
<ul>
<li><a href="#orga095e30">1.1. Notes</a>
<ul>
<li><a href="#orge4feb2c">1.1.1. Why devcontainers</a></li>
</ul>
</li>
<li><a href="#orgc566d1a">1.2. The setup</a>
<ul>
<li><a href="#org5e34e75">1.2.1. How to set up devcontainers</a></li>
<li><a href="#org1234e39">1.2.2. .devcontainers folder</a></li>
<li><a href="#org8b6c7f8">1.2.3. Dockerfile</a></li>
<li><a href="#org077e010">1.2.4. devcontainer.json</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>

<div id="outline-container-org904b03f" class="outline-2">
<h2 id="org904b03f"><span class="section-number-2">1</span> Devcontainers</h2>
<div class="outline-text-2" id="text-1">
<p>
STOPPED USING IT HERE (due to slowliness) - <a href="https://github.com/azegas/quotes/commit/9477b9062be2e9ac0aa2b7158cfdebabac6a4f54">https://github.com/azegas/quotes/commit/9477b9062be2e9ac0aa2b7158cfdebabac6a4f54</a>
</p>
</div>

<div id="outline-container-orga095e30" class="outline-3">
<h3 id="orga095e30"><span class="section-number-3">1.1</span> Notes</h3>
<div class="outline-text-3" id="text-1-1">
</div>
<div id="outline-container-orge4feb2c" class="outline-4">
<h4 id="orge4feb2c"><span class="section-number-4">1.1.1</span> Why devcontainers</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
Kind of nice to have this practice. People use it at work also. Linux environment&#x2026; what could go wrong.
</p>

<p>
To run a project on windows, you need to install:
</p>

<ul class="org-ul">
<li>python</li>
<li>have virtual environments</li>
<li>install packages</li>
</ul>

<p>
Then to edit the code, you need to install vscode and it's packages:
</p>

<ul class="org-ul">
<li>linting</li>
<li>black</li>
</ul>

<p>
Then to run the program, you again need some packages
</p>

<ul class="org-ul">
<li>from the virtual environmnent</li>
<li>from the vscode</li>
</ul>

<p>
Dev containers allow us to have <code>one Dockerfile</code> in which we describe what the
project needs. Then it also allows us to describe how the developer environment
should look like, which VSCode packages should be installed for the developer
that is opening this project and so on (jinja, pylance, w/e else).
</p>
</div>
</div>
</div>

<div id="outline-container-orgc566d1a" class="outline-3">
<h3 id="orgc566d1a"><span class="section-number-3">1.2</span> The setup</h3>
<div class="outline-text-3" id="text-1-2">
</div>
<div id="outline-container-org5e34e75" class="outline-4">
<h4 id="org5e34e75"><span class="section-number-4">1.2.1</span> How to set up devcontainers</h4>
<div class="outline-text-4" id="text-1-2-1">
<ul class="org-ul">
<li><a href="https://github.com/azegas/quotes/issues/47">My own reference task from quotes project</a></li>
<li><a href="https://www.youtube.com/watch?v=b1RavPr_878&amp;ab_channel=VisualStudioCode">YouTube Totorial</a></li>
<li><a href="https://code.visualstudio.com/docs/devcontainers/containers">Official DevContainer docs</a></li>
<li><a href="https://www.youtube.com/watch?v=61M2takIKl8&amp;ab_channel=VisualStudioCode">8 series tutorial to get to know what are dev containers</a></li>
<li><a href="https://github.com/azegas/quotes/commit/db8585e3aa7b84a33aa1c3b1720cd6691c14a955">example of a working devcontainer for quotes project</a></li>
</ul>

<p>
Steps:
</p>

<ul class="org-ul">
<li>install `remote-development` extension in VsCode (contains devcontainers)</li>
<li>Have Docker running</li>
<li>have `.devcontainer` folder in your project</li>
<li>Re-open the project in the container with `re-open in container` command</li>
<li>check if the nice zsh terminal is included.</li>
</ul>

<p>
Keep in mind that you don't have to copy any files from one environment to the dev container, like you usually need with Docker images. With Devcontainers, the files are used from your local machine, but opened in a separate VsCode environment, with fresh plate, no extensions, nothing, only what you have specified.
</p>
</div>
</div>

<div id="outline-container-org1234e39" class="outline-4">
<h4 id="org1234e39"><span class="section-number-4">1.2.2</span> .devcontainers folder</h4>
<div class="outline-text-4" id="text-1-2-2">
<p>
Create <code>.devcontainers</code> folder in your project's root directory.
</p>
</div>
</div>
<div id="outline-container-org8b6c7f8" class="outline-4">
<h4 id="org8b6c7f8"><span class="section-number-4">1.2.3</span> Dockerfile</h4>
<div class="outline-text-4" id="text-1-2-3">
<p>
Inside of the <code>.devcontainers</code> folder, create a <code>Dockerfile</code> file with the
content below:
</p>

<div class="org-src-container">
<pre class="src src-bash">
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">inspiration taken from here - https://github.com/devcontainers/images/blob/main/src/python/.devcontainer/Dockerfile</span>

FROM mcr.microsoft.com/devcontainers/python:1-3.12

RUN apt-get update <span style="font-style: italic;">\</span>
    &amp;&amp; <span style="font-weight: bold; font-style: italic;">DEBIAN_FRONTEND</span>=noninteractive apt-get install -y --no-install-recommends <span style="font-style: italic;">\</span>
        git <span style="font-style: italic;">\</span>
    &amp;&amp; apt-get clean <span style="font-style: italic;">\</span>
    &amp;&amp; rm -rf /var/lib/apt/lists/*

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Install Python dependencies from requirements</span>
COPY requirements.txt ./
RUN python3 -m pip install --upgrade pip <span style="font-style: italic;">\</span>
    &amp;&amp; pip3 install -r requirements.txt <span style="font-style: italic;">\</span>
    &amp;&amp; rm -rf requirements.txt
</pre>
</div>
</div>
</div>

<div id="outline-container-org077e010" class="outline-4">
<h4 id="org077e010"><span class="section-number-4">1.2.4</span> devcontainer.json</h4>
<div class="outline-text-4" id="text-1-2-4">
<p>
Alongisde the Dockerfile, create a `devcontainer.json` file with this content:
</p>

<div class="org-src-container">
<pre class="src src-bash">// inspiration from here - https://github.com/devcontainers/images/blob/main/src/python/.devcontainer/devcontainer.json

{
    <span style="font-style: italic;">"name"</span>: <span style="font-style: italic;">"Quotes Container"</span>,

    // Build configuration
    <span style="font-style: italic;">"build"</span>: {
        <span style="font-style: italic;">"dockerfile"</span>: <span style="font-style: italic;">"./Dockerfile"</span>,
        <span style="font-style: italic;">"context"</span>: <span style="font-style: italic;">"."</span> // <span style="font-style: italic;">".."</span> would allows to reach files outside of the .dockerfile folder
    },

    // Features to be installed<span style="font-weight: bold;"> in</span> the container
    <span style="font-style: italic;">"features"</span>: {
        <span style="font-style: italic;">"ghcr.io/devcontainers/features/common-utils:2"</span>:{
            <span style="font-style: italic;">"installZsh"</span>: <span style="font-style: italic;">"true"</span>,
            <span style="font-style: italic;">"username"</span>: <span style="font-style: italic;">"vscode"</span>,
            <span style="font-style: italic;">"userUid"</span>: <span style="font-style: italic;">"1000"</span>,
            <span style="font-style: italic;">"userGid"</span>: <span style="font-style: italic;">"1000"</span>,
            <span style="font-style: italic;">"upgradePackages"</span>: <span style="font-style: italic;">"true"</span>
        },
        <span style="font-style: italic;">"ghcr.io/devcontainers/features/python:1"</span>: <span style="font-style: italic;">"none"</span>,
        <span style="font-style: italic;">"ghcr.io/devcontainers/features/node:1"</span>: <span style="font-style: italic;">"none"</span>,
        <span style="font-style: italic;">"ghcr.io/devcontainers/features/git:1"</span>: {
            <span style="font-style: italic;">"version"</span>: <span style="font-style: italic;">"latest"</span>,
            <span style="font-style: italic;">"ppa"</span>: <span style="font-style: italic;">"false"</span>
        }
    },

  // Customizations for VS Code
  <span style="font-style: italic;">"customizations"</span>: {
    // Configure properties specific to VS Code.
    <span style="font-style: italic;">"vscode"</span>: {
      // Add the IDs of extensions you want installed when the container is created.
      <span style="font-style: italic;">"extensions"</span>: [
        <span style="font-style: italic;">"ms-python.black-formatter"</span>,
        <span style="font-style: italic;">"VisualStudioExptTeam.vscodeintellicode"</span>,
        <span style="font-style: italic;">"ms-python.isort"</span>,
        <span style="font-style: italic;">"ms-python.pylint"</span>,
        <span style="font-style: italic;">"streetsidesoftware.code-spell-checker"</span>,
        <span style="font-style: italic;">"batisteo.vscode-django"</span>,
        <span style="font-style: italic;">"ms-azuretools.vscode-docker"</span>,
        <span style="font-style: italic;">"eamodio.gitlens"</span>,
        <span style="font-style: italic;">"yzhang.markdown-all-in-one"</span>,
        <span style="font-style: italic;">"GitHub.github-vscode-theme"</span>
      ],
      // Set *default* container specific settings.json values on container create.
      <span style="font-style: italic;">"settings"</span>: {
        <span style="font-style: italic;">"workbench.sideBar.location"</span>: <span style="font-style: italic;">"right"</span>,
        <span style="font-style: italic;">"workbench.colorTheme"</span>: <span style="font-style: italic;">"GitHub Dark Default"</span>,
        <span style="font-style: italic;">"editor.minimap.enabled"</span>: false,
        <span style="font-style: italic;">"editor.smoothScrolling"</span>: true,
        <span style="font-style: italic;">"editor.formatOnType"</span>: true,
        <span style="font-style: italic;">"files.trimTrailingWhitespace"</span>: true,
        <span style="font-style: italic;">"python.defaultInterpreterPath"</span>: <span style="font-style: italic;">"/usr/local/bin/python"</span>,
        <span style="font-style: italic;">"python.formatting.provider"</span>:<span style="font-style: italic;">"black"</span>,
        <span style="font-style: italic;">"[python]"</span>: {
          <span style="font-style: italic;">"editor.formatOnSave"</span>: true
        },
        <span style="font-style: italic;">"emmet.includeLanguages"</span>: {
          <span style="font-style: italic;">"django-html"</span>: <span style="font-style: italic;">"html"</span> // allow html tag completion<span style="font-weight: bold;"> in</span> django html mode https://github.com/vscode-django/vscode-django/issues/125
        }
    }
  },
  // Use <span style="font-style: italic;">'forwardPorts'</span> to make a list of ports inside the container available locally.
  // <span style="font-style: italic;">"forwardPorts"</span>: [],

  // Use <span style="font-style: italic;">'postCreateCommand'</span> to run commands after the container is created.
  <span style="font-style: italic;">"postCreateCommand"</span>: <span style="font-style: italic;">"python --version"</span>,

  // Set <span style="font-weight: bold;">`remoteUser`</span> to <span style="font-weight: bold;">`root`</span> to connect as root instead. More info: https://aka.ms/vscode-remote/containers/non-root.
  <span style="font-style: italic;">"remoteUser"</span>: <span style="font-style: italic;">"vscode"</span>
  }}
</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/>
	 <footer>
	 <p class="date generated">This note is <u>first written</u>: 2024-05-27 Mon 15:04</p>
	 <div class="copyright-container generated">
	 <div class="copyright">
	 Copyright &copy; 2023-2024 Arvydas Gasparavicius
	 </div>
	 </div>
	 <!-- Had to comment out this, because of the github actions, read in the docs for more detail -->
	 <!-- <p class="date">This org file is <u>exported</u> to HTML: 2024-06-04 Tue 07:10</p> -->
	 <!-- <p class="date">This org file is last <u>modified</u>: 2024-06-04 Tue 07:09</p> -->
	 <!-- <p class="date">This org file is <u>created</u>: 2024-05-27 Mon 15:04</p> -->
	 <div class="generated">
	Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.1 (<a href="https://orgmode.org">Org</a> mode 9.3) on <a href="https://www.gnu.org">GNU</a>/<a href="https://www.kernel.org/">Linux</a>
	</div>
	</footer>
	 <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
	 <script src="./static/js/generic.js"></script>
	 <script src="./static/js/scroll-to-top.js"></script>
	 <script src="./static/js/lightbox.js"></script>
	 <script src="./static/js/search.js"></script>
</div>
</body>
</html>
