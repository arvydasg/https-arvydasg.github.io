<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2024-05-30 Thu 17:27 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Building django_starter application step by step</title>
<meta name="author" content="Arvydas Gasparavicius" />
<meta name="description" content="Welcome to my devnotes site" />
<meta name="keywords" content="emacs django" />
<meta name="generator" content="Org Mode" />

<link rel="stylesheet" href="./static/css/org-html-style-default.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/generic.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/taingram.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/lightbox.css" type="text/css"/>
<link rel="stylesheet" href="./static/css/scroll-to-top.css" type="text/css"/>
<link rel="icon" href="./static/ag.ico">
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="sitemap.html">NOTES </a>
 
 <a accesskey="H" href="index.html"> HOME </a>
</div><div id="preamble" class="status">
<div id="updated">Updated: 2024-05-30 Thu 17:26</div>
</div>
<div id="content" class="content">
<header>
<h1 class="title">Building django_starter application step by step</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org5f2ec24">1. Introduction</a></li>
<li><a href="#org38a712a">2. Set up virtual environment</a></li>
<li><a href="#org7293ba0">3. Create a base project</a>
<ul>
<li><a href="#org0f0c1d1">3.1. Start a Django project</a></li>
<li><a href="#org2f9a875">3.2. Create a basic view in <code>views.py</code></a></li>
<li><a href="#org072f52f">3.3. Update <code>urls.py</code></a></li>
<li><a href="#orgd6d2943">3.4. Set up templates in <code>settings.py</code></a></li>
<li><a href="#org3bcb1f5">3.5. Create an <code>index.html</code> for the project</a></li>
<li><a href="#org53d607e">3.6. Run the project for the first time</a></li>
<li><a href="#org20508a7">3.7. Create a <code>base.html</code> template for nav and footer</a></li>
<li><a href="#org2fe9352">3.8. Add MISC items (Add css, js, images, debug toolbar)</a>
<ul>
<li><a href="#orgd30bc73">3.8.1. Add css</a></li>
<li><a href="#orgcb7c7fa">3.8.2. Add js</a></li>
<li><a href="#orgbeca323">3.8.3. Add images</a></li>
</ul>
</li>
<li><a href="#org2d836eb">3.9. Add bootstrap styling</a></li>
<li><a href="#org520dcf4">3.10. HTML templates for error messages</a></li>
<li><a href="#org6bbd52b">3.11. Environment variables</a></li>
</ul>
</li>
<li><a href="#org4bec9f4">4. Authentication</a>
<ul>
<li><a href="#orga7e1bad">4.1. Built in Authentication</a>
<ul>
<li><a href="#orgf6961ad">4.1.1. Get to know to Django's built-in in authentication system</a></li>
<li><a href="#orgc3fa73c">4.1.2. Log In functionality</a></li>
<li><a href="#orga30f8c7">4.1.3. Log Out functionality</a></li>
<li><a href="#orge35a1f1">4.1.4. Sign Up functionality</a></li>
<li><a href="#org1722289">4.1.5. Password Change</a></li>
<li><a href="#org1718aea">4.1.6. Password Reset</a></li>
</ul>
</li>
<li><a href="#org369e6c1">4.2. Custom user model/extended authentication</a>
<ul>
<li><a href="#org7261890">4.2.1. AbstractUser vs AbstractBaseUser</a></li>
</ul>
</li>
<li><a href="#orgc2d4b87">4.3. Implement crispy forms</a></li>
<li><a href="#org57ac49e">4.4. Create a user dashboard</a></li>
</ul>
</li>
<li><a href="#org437cb15">5. Nice to haves</a>
<ul>
<li><a href="#orgb1c0df2">5.1. Set up Makefile</a></li>
<li><a href="#orgef04b73">5.2. Django-debug-toolbar</a></li>
<li><a href="#org028a4b9">5.3. Basic tests</a></li>
<li><a href="#org2da72a5">5.4. Github actions</a></li>
<li><a href="#org04cc4c1">5.5. Black formatter</a></li>
<li><a href="#orgea167c6">5.6. For security reasons, rename /admin to something else</a></li>
</ul>
</li>
<li><a href="#orgeeeff9d">6. Other TODO's</a>
<ul>
<li><a href="#org5185c6a">6.1. PROGRESS check djangox viska ir panaudok kiek gali is ten</a></li>
<li><a href="#org08f0d54">6.2. <span class="todo TODO">TODO</span> Create a simple test app, models of it here - Models</a>
<ul>
<li><a href="#org31cdefc">6.2.1. Little cheat before making models</a></li>
<li><a href="#org85780ee">6.2.2. Creating database models</a></li>
</ul>
</li>
<li><a href="#orgb7e03c7">6.3. <span class="todo TODO">TODO</span> Improve the project</a>
<ul>
<li><a href="#org2d3e562">6.3.1. add messages support</a></li>
<li><a href="#orgd998cf2">6.3.2. Images for production</a></li>
</ul>
</li>
<li><a href="#org6ef1f2c">6.4. <span class="todo TODO">TODO</span> Pro Django tutorials by thenewboston</a></li>
<li><a href="#orga73999c">6.5. <span class="todo TODO">TODO</span> clean requirements.txt, make sure only needed packages are installed</a></li>
<li><a href="#org575def0">6.6. <span class="todo TODO">TODO</span> CRUD functionality with HTMX</a></li>
<li><a href="#org4a8a6a9">6.7. <span class="todo TODO">TODO</span> Dockerfile (in the far future)</a></li>
<li><a href="#org91bb3a7">6.8. <span class="todo TODO">TODO</span> Allauth?????!!! is it needed?</a></li>
<li><a href="#org38bf398">6.9. <span class="todo TODO">TODO</span> look into cookie-cutter</a></li>
<li><a href="#org7e3a383">6.10. <span class="todo TODO">TODO</span> check health</a></li>
</ul>
</li>
</ul>
</div>
</nav>

<div id="outline-container-org5f2ec24" class="outline-2">
<h2 id="org5f2ec24"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
This is a Django app that I use at the beginning of every new Django project.
</p>
</div>
</div>

<div id="outline-container-org38a712a" class="outline-2">
<h2 id="org38a712a"><span class="section-number-2">2.</span> Set up virtual environment</h2>
<div class="outline-text-2" id="text-2">
<p>
On windows, we will user virtualenvwrapper -
<a href="https://virtualenvwrapper.readthedocs.io/en/latest/command_ref.html">https://virtualenvwrapper.readthedocs.io/en/latest/command_ref.html</a>
</p>

<div class="org-src-container">
<pre class="src src-bash">pip install virtualenvwrapper
mkvirtualenv venv
lsvirtualenv
workon venv
pip install django
pip freeze &gt; requirements.txt
</pre>
</div>
</div>
</div>

<div id="outline-container-org7293ba0" class="outline-2">
<h2 id="org7293ba0"><span class="section-number-2">3.</span> Create a base project</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org0f0c1d1" class="outline-3">
<h3 id="org0f0c1d1"><span class="section-number-3">3.1.</span> Start a Django project</h3>
<div class="outline-text-3" id="text-3-1">
<div class="org-src-container">
<pre class="src src-bash">django-admin startproject project .
python manage.py runserver
</pre>
</div>

<blockquote>
<p>
We will not create and run migrations until the later point (because we will
create a custom user model).
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org2f9a875" class="outline-3">
<h3 id="org2f9a875"><span class="section-number-3">3.2.</span> Create a basic view in <code>views.py</code></h3>
<div class="outline-text-3" id="text-3-2">
<p>
Create a <code>views.py</code> in project folder and add this content:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.shortcuts <span style="font-weight: bold;">import</span> render
<span style="font-weight: bold;">from</span> django.views <span style="font-weight: bold;">import</span> View
<span style="font-weight: bold;">from</span> django.http <span style="font-weight: bold;">import</span> HttpResponse

<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Index</span>(View):
    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">get</span>(<span style="font-weight: bold;">self</span>, request):
        <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">"project/index.html"</span>)

<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test</span>(request):
    <span style="font-weight: bold;">return</span> HttpResponse(<span style="font-style: italic;">'&lt;h2&gt;Test&lt;/h2&gt;'</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org072f52f" class="outline-3">
<h3 id="org072f52f"><span class="section-number-3">3.3.</span> Update <code>urls.py</code></h3>
<div class="outline-text-3" id="text-3-3">
<p>
Create <code>urls.py</code> in project folder and add this content:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.contrib <span style="font-weight: bold;">import</span> admin
<span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> include, path

<span style="font-weight: bold;">from</span> project.views <span style="font-weight: bold;">import</span> Index, test <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>

<span style="font-weight: bold; font-style: italic;">urlpatterns</span> = [
    path(<span style="font-style: italic;">"admin/"</span>, admin.site.urls),
    path(<span style="font-style: italic;">"accounts/"</span>, include(<span style="font-style: italic;">"django.contrib.auth.urls"</span>)),
    path(<span style="font-style: italic;">""</span>, Index.as_view(), name=<span style="font-style: italic;">"index"</span>), <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
    path(<span style="font-style: italic;">'test/'</span>, test, name=<span style="font-style: italic;">"test"</span>), <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">test</span>
]
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd6d2943" class="outline-3">
<h3 id="orgd6d2943"><span class="section-number-3">3.4.</span> Set up templates in <code>settings.py</code></h3>
<div class="outline-text-3" id="text-3-4">
<p>
For django to be able to find our html files, let's tell django about their
location in <code>settings.py</code>, make a modification to the TEMPLATES variable:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-style: italic;">"DIRS"</span>: [os.path.join(BASE_DIR, <span style="font-style: italic;">"templates"</span>)],
</pre>
</div>
</div>
</div>

<div id="outline-container-org3bcb1f5" class="outline-3">
<h3 id="org3bcb1f5"><span class="section-number-3">3.5.</span> Create an <code>index.html</code> for the project</h3>
<div class="outline-text-3" id="text-3-5">
<p>
To be able to display the <code>index.html we have just defined in =views.py</code>
created, we need to set up the templates correctly.
</p>

<p>
Go ahead and create <code>index.html</code> inside of the <code>templates/project</code> directory,
the content of it:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">p</span>&gt;Welcome to index.html&lt;/<span style="font-weight: bold;">p</span>&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-org53d607e" class="outline-3">
<h3 id="org53d607e"><span class="section-number-3">3.6.</span> Run the project for the first time</h3>
<div class="outline-text-3" id="text-3-6">
<p>
Do a <code>python manage.py runserver</code> now and you will be presented with the index
page with <b><b>Welcome to index.html</b></b> displayed in it.
</p>

<p>
When visiting /test, you should see the test view. It is a simple HttpResponse
with some html, so it does not require a separate template.
</p>
</div>
</div>

<div id="outline-container-org20508a7" class="outline-3">
<h3 id="org20508a7"><span class="section-number-3">3.7.</span> Create a <code>base.html</code> template for nav and footer</h3>
<div class="outline-text-3" id="text-3-7">
<p>
We want to display some sort of navigation and footer on ALL pages in our site.
</p>

<p>
Instead of modifying each template and adding those things, we can specify it
in one place and tell django to put that single piece of template into each
django .html page.
</p>

<p>
Inside of the <code>templates</code> folder, create <code>base</code> folder and then <code>base.html</code> in
it with such content:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">!DOCTYPE</span> html&gt;
&lt;<span style="font-weight: bold;">html</span> <span style="font-weight: bold; font-style: italic;">lang</span>=<span style="font-style: italic;">"en"</span>&gt;
  &lt;<span style="font-weight: bold;">head</span>&gt;
    &lt;<span style="font-weight: bold;">meta</span> <span style="font-weight: bold; font-style: italic;">charset</span>=<span style="font-style: italic;">"UTF-8"</span>&gt;
    &lt;<span style="font-weight: bold;">meta</span> <span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">"viewport"</span> <span style="font-weight: bold; font-style: italic;">content</span>=<span style="font-style: italic;">"width=device-width, initial-scale=1.0"</span>&gt;
    &lt;<span style="font-weight: bold;">meta</span> <span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">"description"</span> <span style="font-weight: bold; font-style: italic;">content</span>=<span style="font-style: italic;">"Project"</span>&gt;
    &lt;<span style="font-weight: bold;">title</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Project</span>&lt;/<span style="font-weight: bold;">title</span>&gt;
  &lt;/<span style="font-weight: bold;">head</span>&gt;
  &lt;<span style="font-weight: bold;">body</span>&gt;

    <span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">This will act as a navbar</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
    {% include 'base/navbar.html' %}

    {% block content %}

    {% endblock content %}

    <span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">This will act as a footer</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
    {% include 'base/footer.html' %}

  &lt;/<span style="font-weight: bold;">body</span>&gt;
&lt;/<span style="font-weight: bold;">html</span>&gt;
</pre>
</div>

<p>
Now create a <code>base/navbar.html</code> and <code>base/footer.html</code> pages:
</p>

<div class="org-src-container">
<pre class="src src-html"><span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">navbar.html</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
&lt;<span style="font-weight: bold;">p</span> <span style="font-weight: bold; font-style: italic;">class</span>=<span style="font-style: italic;">"navbar"</span>&gt;Hello this is navbar&lt;/<span style="font-weight: bold;">p</span>&gt;

{% if user.is_authenticated and user.is_superuser %}
&lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'admin:index' %}"</span>&gt;Admin panel&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
{% endif %}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-html"><span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">footer.html</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
&lt;<span style="font-weight: bold;">p</span> <span style="font-weight: bold; font-style: italic;">class</span>=<span style="font-style: italic;">"footer"</span>&gt;Hello this is footer&lt;/<span style="font-weight: bold;">p</span>&gt;
</pre>
</div>

<p>
Check how homepage(index.html) looks now.
</p>
</div>
</div>
<div id="outline-container-org2fe9352" class="outline-3">
<h3 id="org2fe9352"><span class="section-number-3">3.8.</span> Add MISC items (Add css, js, images, debug toolbar)</h3>
<div class="outline-text-3" id="text-3-8">
</div>
<div id="outline-container-orgd30bc73" class="outline-4">
<h4 id="orgd30bc73"><span class="section-number-4">3.8.1.</span> Add css</h4>
<div class="outline-text-4" id="text-3-8-1">
<p>
In project's root directory, create a folder called <code>static</code>. Inside of it,
another folder called <code>css</code>. Inside of it, create a file called <code>base.css</code>.
</p>

<p>
It's contents for now:
</p>

<div class="org-src-container">
<pre class="src src-css"><span style="font-weight: bold;">p</span> {
    <span style="font-weight: bold;">color</span>: <span style="color: #000000; background-color: #008000;">green</span>;
}

<span style="font-weight: bold;">.navbar</span> {
    <span style="font-weight: bold;">padding</span>: 20px;
    <span style="font-weight: bold;">background-color</span>: <span style="color: #000000; background-color: #add8e6;">lightblue</span>;
}

<span style="font-weight: bold;">.footer</span> {
    <span style="font-weight: bold;">padding</span>: 20px;
    <span style="font-weight: bold;">background-color</span>: <span style="color: #000000; background-color: #d3d3d3;">lightgrey</span>;
}
</pre>
</div>

<p>
Inside of <code>base.html</code>, in head section, add this line:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">link</span> <span style="font-weight: bold; font-style: italic;">rel</span>=<span style="font-style: italic;">"stylesheet"</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"text/css"</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% static 'css/base.css' %}"</span>&gt;
</pre>
</div>

<p>
Now at the top of <code>base.html</code> add this line:
</p>

<div class="org-src-container">
<pre class="src src-html">{% load static %}
</pre>
</div>

<p>
Make sure these are in your <code>settings.py</code> file:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">STATIC_URL</span> = <span style="font-style: italic;">"static/"</span>
<span style="font-weight: bold; font-style: italic;">STATICFILES_DIRS</span> = [BASE_DIR / <span style="font-style: italic;">"static"</span>]
</pre>
</div>

<p>
Refresh your page. All the text should be green now, navbar and footer should
have some styling as well!
</p>
</div>
</div>

<div id="outline-container-orgcb7c7fa" class="outline-4">
<h4 id="orgcb7c7fa"><span class="section-number-4">3.8.2.</span> Add js</h4>
<div class="outline-text-4" id="text-3-8-2">
<p>
Create <code>static/js</code> folder and inside of it - <code>scripts.js</code> file.
</p>

<p>
Content of it:
</p>

<div class="org-src-container">
<pre class="src src-javascript"><span style="font-weight: bold;">function</span> <span style="font-weight: bold;">myFunction</span>() {
    alert(<span style="font-style: italic;">"Hello from a static file!"</span>);
  }
</pre>
</div>

<p>
Then in <code>base.html</code> include that script, put it just above the closing
<code>&lt;/body&gt;</code> tag like such:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">script</span> <span style="font-weight: bold; font-style: italic;">src</span>=<span style="font-style: italic;">"{% static 'js/scripts.js' %}"</span>&gt;&lt;/<span style="font-weight: bold;">script</span>&gt;
</pre>
</div>

<p>
In <code>index.html</code> add a button that will trigger the alert function:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">button</span> <span style="font-weight: bold; font-style: italic;">onclick</span>=<span style="font-style: italic;">"myFunction()"</span>&gt;JavaScript test&lt;/<span style="font-weight: bold;">button</span>&gt;
</pre>
</div>

<p>
Reload the page. Clicking on the button should trigger js code.
</p>
</div>
</div>

<div id="outline-container-orgbeca323" class="outline-4">
<h4 id="orgbeca323"><span class="section-number-4">3.8.3.</span> Add images</h4>
<div class="outline-text-4" id="text-3-8-3">
<p>
Now let's say you want to serve an image from the <code>index.html</code> page.
</p>

<p>
Place your image in <code>static/images/</code> folder,
</p>

<p>
Then in <code>index.html</code> add such two new lines:
</p>

<div class="org-src-container">
<pre class="src src-html"><span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">index.html</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
{% extends "base/base.html" %}

{% load static %} <span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">new</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>

{% block content %}

&lt;<span style="font-weight: bold;">p</span>&gt;Hello&lt;/<span style="font-weight: bold;">p</span>&gt;

&lt;<span style="font-weight: bold;">img</span> <span style="font-weight: bold; font-style: italic;">src</span>=<span style="font-style: italic;">"{% static 'images/pineapple.jpeg' %}"</span>&gt; <span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">new</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>

{% endblock content %}
</pre>
</div>

<p>
Refresh the page, image should be displayed.
</p>
</div>
</div>
</div>

<div id="outline-container-org2d836eb" class="outline-3">
<h3 id="org2d836eb"><span class="section-number-3">3.9.</span> Add bootstrap styling</h3>
<div class="outline-text-3" id="text-3-9">
<ul class="org-ul">
<li>Tailwind - needs node, bloats the html page</li>
<li>Bulma - never used, something new, not so popular?</li>
<li>Bootstrap - old and popular, got CND's for css/js</li>
</ul>

<p>
Choosing bootstrap.
</p>

<p>
In <code>base.html</code> add this to the head tag for bootstrap css:
</p>

<div class="org-src-container">
<pre class="src src-html">{% block css %}
<span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">Bootstrap CSS</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
&lt;<span style="font-weight: bold;">link</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"</span> <span style="font-weight: bold; font-style: italic;">rel</span>=<span style="font-style: italic;">"stylesheet"</span>
      <span style="font-weight: bold; font-style: italic;">integrity</span>=<span style="font-style: italic;">"sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"</span> <span style="font-weight: bold; font-style: italic;">crossorigin</span>=<span style="font-style: italic;">"anonymous"</span>&gt;

{% endblock %}
</pre>
</div>

<p>
Find the latest tag here - <a href="https://www.bootstrapcdn.com/">https://www.bootstrapcdn.com/</a>
</p>

<p>
Then add boostrap js, at the bottom of the <code>base.html</code> page, at the closing body tag.
</p>

<div class="org-src-container">
<pre class="src src-html">{% block javascript %}
<span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">Bootstrap JavaScript</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
&lt;<span style="font-weight: bold;">script</span> <span style="font-weight: bold; font-style: italic;">src</span>=<span style="font-style: italic;">"https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"</span>
        <span style="font-weight: bold; font-style: italic;">integrity</span>=<span style="font-style: italic;">"sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"</span>
        <span style="font-weight: bold; font-style: italic;">crossorigin</span>=<span style="font-style: italic;">"anonymous"</span>&gt;&lt;/<span style="font-weight: bold;">script</span>&gt;
{% endblock javascript %}
</pre>
</div>

<p>
Bootstrap should work now.
</p>
</div>
</div>

<div id="outline-container-org520dcf4" class="outline-3">
<h3 id="org520dcf4"><span class="section-number-3">3.10.</span> HTML templates for error messages</h3>
<div class="outline-text-3" id="text-3-10">
<p>
Whenever the debug is True we will see the debug information and why certain
page could not be opened. But whenever the debug is False, we have nothing so
show as of now besides the standard web browser message.
</p>

<p>
Instead of that, we will create our own.
</p>

<p>
<a href="https://www.w3schools.com/django/django_404.php">https://www.w3schools.com/django/django_404.php</a>
</p>

<p>
Whenever the debug is True we will see the debug information and why
certain page could not be opened. But whenever the debug is False, we
have nothing so show as of now besides the standard web browser
message.
</p>

<p>
Instead of that, we will create our own.
</p>

<p>
<a href="https://www.w3schools.com/django/django_404.php">https://www.w3schools.com/django/django_404.php</a>
</p>

<p>
403_csrf.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends '_base.html' %}

{% block title %}Forbidden (403){% endblock title %}

{% block content %}
    &lt;<span style="font-weight: bold;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Forbidden (403)</span>&lt;/<span style="font-weight: bold;">h1</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;CSRF verification failed. Request aborted.&lt;/<span style="font-weight: bold;">p</span>&gt;
{% endblock content %}
</pre>
</div>

<p>
404.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends '_base.html' %}

{% block title %}404 Page not found{% endblock %}

{% block content %}
    &lt;<span style="font-weight: bold;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">Page not found</span>&lt;/<span style="font-weight: bold;">h1</span>&gt;
{% endblock content %}
</pre>
</div>

<p>
500.html
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends '_base.html' %}

{% block title %}500 Server Error{% endblock %}

{% block content %}
    &lt;<span style="font-weight: bold;">h1</span>&gt;<span style="font-weight: bold; text-decoration: underline;">500 Server Error</span>&lt;/<span style="font-weight: bold;">h1</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;Looks like something went wrong!&lt;/<span style="font-weight: bold;">p</span>&gt;
{% endblock content %}
</pre>
</div>

<p>
Now turn debug to False, add allowed hosts and go to a random url to check if
the templates are being read:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">DEBUG</span> = <span style="font-weight: bold; text-decoration: underline;">False</span>
<span style="font-weight: bold; font-style: italic;">ALLOWED_HOSTS</span> = [<span style="font-style: italic;">'127.0.0.1'</span>, <span style="font-style: italic;">'localhost'</span>]
</pre>
</div>
</div>
</div>

<div id="outline-container-org6bbd52b" class="outline-3">
<h3 id="org6bbd52b"><span class="section-number-3">3.11.</span> Environment variables</h3>
<div class="outline-text-3" id="text-3-11">
<p>
We don't want to push secret variables to github.
</p>

<p>
Such variables that should be kept secret are:
</p>
<ul class="org-ul">
<li>Secret key</li>
<li>Debug</li>
</ul>

<div class="org-src-container">
<pre class="src src-bash">pip install python-dotenv
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> dotenv <span style="font-weight: bold;">import</span> load_dotenv

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Load environment variables from .env</span>
load_dotenv()
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">SECRET_KEY</span> = os.getenv(<span style="font-style: italic;">"SECRET_KEY"</span>)
<span style="font-weight: bold; font-style: italic;">DEBUG</span> = os.getenv(<span style="font-style: italic;">"DEBUG"</span>) == <span style="font-style: italic;">"True"</span>
</pre>
</div>

<p>
Now let's create .env_template file that will act as our template for secret
environment variables, so we don't forget what we are keeping in secret
</p>

<div class="org-src-container">
<pre class="src src-bash"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">no commas after variable declaration</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">no spaces before/after =</span>

<span style="font-weight: bold; font-style: italic;">SECRET_KEY</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">DEBUG</span>=True

<span style="font-weight: bold; font-style: italic;">POSTGRESQL_REMOTE_DB_NAME</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">POSTGRESQL_REMOTE_DB_USER</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">POSTGRESQL_REMOTE_DB_PASSWORD</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">POSTGRESQL_REMOTE_DB_HOST</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">POSTGRESQL_REMOTE_DB_PORT</span>=<span style="font-style: italic;">""</span>

<span style="font-weight: bold; font-style: italic;">POSTGRESQL_LOCAL_DB_NAME</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">POSTGRESQL_LOCAL_DB_USER</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">POSTGRESQL_LOCAL_DB_PASSWORD</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">POSTGRESQL_LOCAL_DB_HOST</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">POSTGRESQL_LOCAL_DB_PORT</span>=<span style="font-style: italic;">""</span>

<span style="font-weight: bold; font-style: italic;">MYSQL_LOCAL_DB_NAME</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">MYSQL_LOCAL_DB_USER</span>=<span style="font-style: italic;">""</span>
<span style="font-weight: bold; font-style: italic;">MYSQL_LOCAL_DB_PASSWORD</span>=<span style="font-style: italic;">""</span>
</pre>
</div>

<p>
Now copy <code>.env_template</code> file and make <code>.env</code> out of it, populate
debug(true/false) and secret variable definition with whatever you like.
</p>

<p>
Now you can change those variables from <code>.env</code> file.
</p>

<p>
Make sure this <code>.env</code> file is not being committed to git, add it to
<code>.gitignore</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-org4bec9f4" class="outline-2">
<h2 id="org4bec9f4"><span class="section-number-2">4.</span> Authentication</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>Biggest inspiration - <a href="https://learndjango.com/tutorials/django-login-and-logout-tutorial">here</a></li>
<li>Another useful resource - <a href="https://simpleisbetterthancomplex.com/tutorial/2016/07/22/how-to-extend-django-user-model.html#abstractbaseuser">here</a></li>
</ul>
</div>

<div id="outline-container-orga7e1bad" class="outline-3">
<h3 id="orga7e1bad"><span class="section-number-3">4.1.</span> Built in Authentication</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-orgf6961ad" class="outline-4">
<h4 id="orgf6961ad"><span class="section-number-4">4.1.1.</span> Get to know to Django's built-in in authentication system</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
In this section, we'll configure a complete <a href="https://docs.djangoproject.com/en/5.0/topics/auth/">user authentication system</a> in
Django consisting of login, logout, signup, password change, and password
reset.
</p>

<p>
The Django <code>contrib=q module provides built-in apps to help with development.
In the =project/settings.py</code> file under <code>INSTALLED_APPS</code>, you can see that
<code>auth</code> is listed and available to us.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">project/settings.py</span>
<span style="font-weight: bold; font-style: italic;">INSTALLED_APPS</span> = [
    <span style="font-style: italic;">"django.contrib.admin"</span>,
    <span style="font-style: italic;">"django.contrib.auth"</span>,  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">THIS!!!!</span>
    <span style="font-style: italic;">"django.contrib.contenttypes"</span>,
    <span style="font-style: italic;">"django.contrib.sessions"</span>,
    <span style="font-style: italic;">"django.contrib.messages"</span>,
    <span style="font-style: italic;">"django.contrib.staticfiles"</span>,
]
</pre>
</div>

<p>
To use the <code>auth</code> app, we need to add it to our project-level <code>project/urls.py</code>
file. At the top, import include and create a new URL path at accounts/. You
can choose a different URL path, but using accounts/ is a standard practice and
requires less customization later.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">project/urls.py</span>
<span style="font-weight: bold;">from</span> django.contrib <span style="font-weight: bold;">import</span> admin
<span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> path, include  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>

<span style="font-weight: bold; font-style: italic;">urlpatterns</span> = [
    path(<span style="font-style: italic;">"admin/"</span>, admin.site.urls),
    path(<span style="font-style: italic;">"accounts/"</span>, include(<span style="font-style: italic;">"django.contrib.auth.urls"</span>)),  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
]
</pre>
</div>

<p>
The auth app we've now included provides us with multiple <a href="https://docs.djangoproject.com/en/5.0/topics/auth/default/#module-django.contrib.auth.views">authentication views</a>
and URLs for handling login, logout, password change, password reset, etc. It
notably does not include a view and URL for signup, so we have to configure
that ourselves.
</p>

<div class="org-src-container">
<pre class="src src-sh">accounts/login/ [<span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">'login'</span>]
accounts/logout/ [<span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">'logout'</span>]
accounts/password_change/ [<span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">'password_change'</span>]
accounts/password_change/done/ [<span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">'password_change_done'</span>]
accounts/password_reset/ [<span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">'password_reset'</span>]
accounts/password_reset/done/ [<span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">'password_reset_done'</span>]
accounts/reset/&lt;uidb64&gt;/&lt;token&gt;/ [<span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">'password_reset_confirm'</span>]
accounts/reset/done/ [<span style="font-weight: bold; font-style: italic;">name</span>=<span style="font-style: italic;">'password_reset_complete'</span>]
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc3fa73c" class="outline-4">
<h4 id="orgc3fa73c"><span class="section-number-4">4.1.2.</span> Log In functionality</h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
Let's make our login page! By default, Django will look within a templates
folder called <code>registration</code> for auth templates. The login template is called
<code>login.html</code>.
</p>

<p>
Inside of the templates directory create a folder called registration:
</p>

<p>
Then create a <code>login.html</code> file and include the following code:
</p>

<div class="org-src-container">
<pre class="src src-html"><span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">templates/registration/login.html</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
&lt;<span style="font-weight: bold;">h2</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">Log In</span>&lt;/<span style="font-weight: bold;">h2</span>&gt;
&lt;<span style="font-weight: bold;">form</span> <span style="font-weight: bold; font-style: italic;">method</span>=<span style="font-style: italic;">"post"</span>&gt;
  {% csrf_token %}
  {{ form }}
  &lt;<span style="font-weight: bold;">button</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"submit"</span>&gt;Log In&lt;/<span style="font-weight: bold;">button</span>&gt;
&lt;/<span style="font-weight: bold;">form</span>&gt;
</pre>
</div>

<p>
This code is a standard Django form using <code>POST</code> to send data and <code>{%
csrf_token %}</code> tags for security concerns, namely to prevent a CSRF Attack. The
form's contents are displayed with <code>{{ form }}</code>, and then we add a "submit"
button.
</p>

<p>
Our login functionality now works, but we should specify where to redirect the
user upon a successful login using the <code>LOGIN_REDIRECT_URL</code> setting. At the
bottom of the <code>settings.py</code> file, add the following to redirect the user to the
homepage.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">project/settings.py</span>
<span style="font-weight: bold; font-style: italic;">LOGIN_REDIRECT_URL</span> = <span style="font-style: italic;">"index"</span>  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
</pre>
</div>

<p>
If you start the Django server again with <code>python manage.py runserver</code> and
navigate to our login page at <code>http://127.0.0.1:8000/accounts/login/</code>, you'll
see the login page.
</p>

<p>
Let's add a navigation link to the login page. In <code>navbar.html</code> add this line:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'login' %}"</span>&gt;login&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
</pre>
</div>

<p>
We can only log in if we have a user account. And since adding a signup form is
yet to come, the most straightforward approach is to make a superuser account
from the command line. Quit the server with <code>Control+c</code> and then run the
command <code>python manage.py createsuperuser</code>. Answer the prompts and note that
your password will not appear on the screen when typing for security reasons.
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">let's make migration first, to create tables in the database</span>
python manage.py makemigrations
python manage.py migrate

python manage.py createsuperuser

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Username (leave blank to use 'root'):</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Email address:</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Password:</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Password (again):</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Superuser created successfully.</span>
</pre>
</div>

<p>
Now start the server again with python manage.py runserver and refresh the page
at <code>http://127.0.0.1:8000/accounts/login/</code>. Enter the login info for your
just-created superuser.
</p>

<p>
Our login worked because it redirected us to the homepage which we have created
earlier.
</p>
</div>
</div>

<div id="outline-container-orga30f8c7" class="outline-4">
<h4 id="orga30f8c7"><span class="section-number-4">4.1.3.</span> Log Out functionality</h4>
<div class="outline-text-4" id="text-4-1-3">
<p>
But how do we log out? The only option currently is to go into the admin panel
at <code>http://127.0.0.1:8000/admin/</code> and click the "Log Out" link in the upper
right corner. The "Logout" link will log us out.
</p>

<blockquote>
<p>
One of the changes to Django 5.0, as noted in the release notes, is the removal
support for logging out via GET requests. In previous versions of Django, you
could add a logout link like <code>&lt;a href</code>" {% url 'logout' %}"&gt;Log Out&lt;/a&gt;= to a
template file. But now a POST request via a form is required.
</p>
</blockquote>

<p>
We already have this in our <code>base.html</code>:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">form</span> <span style="font-weight: bold; font-style: italic;">action</span>=<span style="font-style: italic;">"{% url 'logout' %}"</span> <span style="font-weight: bold; font-style: italic;">method</span>=<span style="font-style: italic;">"post"</span>&gt;
  {% csrf_token %}
  &lt;<span style="font-weight: bold;">button</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"submit"</span>&gt;Log Out&lt;/<span style="font-weight: bold;">button</span>&gt;
&lt;/<span style="font-weight: bold;">form</span>&gt;
</pre>
</div>

<p>
Then we need to update <code>settings.py</code> with our redirect link,
<code>LOGOUT_REDIRECT_URL</code>. Add it right next to our login redirect so the bottom of
the <code>settings.py</code> file should look as follows:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">project/settings.py</span>
<span style="font-weight: bold; font-style: italic;">LOGIN_REDIRECT_URL</span> = <span style="font-style: italic;">"index"</span>
<span style="font-weight: bold; font-style: italic;">LOGOUT_REDIRECT_URL</span> = <span style="font-style: italic;">"index"</span>  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge35a1f1" class="outline-4">
<h4 id="orge35a1f1"><span class="section-number-4">4.1.4.</span> Sign Up functionality</h4>
<div class="outline-text-4" id="text-4-1-4">
<p>
Now that we have sorted out logging in and logging out, it is time to add a
signup page to our basic Django site. If you recall, Django <b><b>does not</b></b>
provide a built-in view or URL for this, so we must code up the form and the
page ourselves.
</p>

<p>
To begin, stop the local webserver with Control+c and create a dedicated app
called accounts, which we'll use for our custom account logic.
</p>

<div class="org-src-container">
<pre class="src src-sh">python manage.py startapp accounts
</pre>
</div>

<p>
We then move the newly created <code>accounts</code> app into <code>apps</code> folder for better
structure in the future. All the apps will be in one folder.
</p>

<p>
Go to <code>apps.py</code> and fix the name variable to be <code>name = "apps.accounts"</code>. From
now on if we want to refernece urls of this app, we will do so by writing
<code>apps.accounts.urls</code>.
</p>

<p>
Make sure to add the new app to the <code>INSTALLED_APPS</code> setting in the
<code>project/settings.py</code> file:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">project/settings.py</span>
<span style="font-weight: bold; font-style: italic;">INSTALLED_APPS</span> = [
    <span style="font-style: italic;">"django.contrib.admin"</span>,
    <span style="font-style: italic;">"django.contrib.auth"</span>,
    <span style="font-style: italic;">"django.contrib.contenttypes"</span>,
    <span style="font-style: italic;">"django.contrib.sessions"</span>,
    <span style="font-style: italic;">"django.contrib.messages"</span>,
    <span style="font-style: italic;">"django.contrib.staticfiles"</span>,
    <span style="font-style: italic;">"apps.accounts"</span>,  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
]
</pre>
</div>

<p>
Then add a URL path in <code>project/urls.py</code> that is <b><b>above</b></b> our included Django
<code>auth</code> app. The order is important here because Django looks for URL patterns
from top-to-bottom. We want to maintain the pattern of having our user
authentication logic at <code>accounts/</code> but ensure that the signup page loads
first.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">django_project/urls.py</span>
<span style="font-weight: bold;">from</span> django.contrib <span style="font-weight: bold;">import</span> admin
<span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> path, include

<span style="font-weight: bold;">from</span> project.views <span style="font-weight: bold;">import</span> Index

<span style="font-weight: bold; font-style: italic;">urlpatterns</span> = [
    path(<span style="font-style: italic;">"admin/"</span>, admin.site.urls),
    path(<span style="font-style: italic;">"accounts/"</span>, include(<span style="font-style: italic;">"apps.accounts.urls"</span>)),  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
    path(<span style="font-style: italic;">"accounts/"</span>, include(<span style="font-style: italic;">"django.contrib.auth.urls"</span>)),
    path(<span style="font-style: italic;">""</span>, Index.as_view(), name=<span style="font-style: italic;">"index"</span>),
]
</pre>
</div>

<p>
Next, create a new file called <code>accounts/urls.py</code> with your text editor and add
the following code.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">accounts/urls.py</span>
<span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> path

<span style="font-weight: bold;">from</span> .views <span style="font-weight: bold;">import</span> SignUpView


<span style="font-weight: bold; font-style: italic;">urlpatterns</span> = [
    path(<span style="font-style: italic;">"signup/"</span>, SignUpView.as_view(), name=<span style="font-style: italic;">"signup"</span>),
]
</pre>
</div>

<p>
Now for the <code>accounts/views.py</code> file:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">accounts/views.py</span>
<span style="font-weight: bold;">from</span> django.contrib.auth.forms <span style="font-weight: bold;">import</span> UserCreationForm
<span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> reverse_lazy
<span style="font-weight: bold;">from</span> django.views.generic <span style="font-weight: bold;">import</span> CreateView


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">SignUpView</span>(CreateView):
    <span style="font-weight: bold; font-style: italic;">form_class</span> = UserCreationForm
    <span style="font-weight: bold; font-style: italic;">success_url</span> = reverse_lazy(<span style="font-style: italic;">"login"</span>)
    <span style="font-weight: bold; font-style: italic;">template_name</span> = <span style="font-style: italic;">"registration/signup.html"</span>
</pre>
</div>

<p>
At the top we import <a href="https://docs.djangoproject.com/en/5.0/topics/auth/default/#django.contrib.auth.forms.UserCreationForm%20">UserCreationForm</a>, <a href="https://docs.djangoproject.com/en/5.0/ref/urlresolvers/#reverse-lazy">reverse_lazy</a>, and the generic
class-based view <a href="https://docs.djangoproject.com/en/5.0/ref/class-based-views/generic-editing/#django.views.generic.edit.CreateView">CreateView</a>.
</p>

<p>
We are creating a new class called <code>SignUpView</code> that extends <code>CreateView</code>, sets
the form as <code>UserCreationForm</code>, and uses the <b>not-yet-created</b> template
<code>signup.html</code>. Note that we use <code>reverse_lazy</code> to redirect users to the login
page upon successful registration rather than <code>reverse</code>, because <b>for all
generic class-based views</b>, the URLs are not loaded when the file is imported,
so we have to use the lazy form of reverse to load them later when we are sure
they're available.
</p>

<p>
Ok, now for the final step. Create a new template,
<code>templates/registration/signup.html</code>, and populate it with this code that looks
almost exactly like what we used for <code>login.html</code>.
</p>

<div class="org-src-container">
<pre class="src src-html"><span style="font-weight: bold; font-style: italic;">&lt;!-- </span><span style="font-weight: bold; font-style: italic;">templates/registration/signup.html</span><span style="font-weight: bold; font-style: italic;"> --&gt;</span>
{% extends "base.html" %}

{% block title %}Sign Up{% endblock %}

{% block content %}
&lt;<span style="font-weight: bold;">h2</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">Sign up</span>&lt;/<span style="font-weight: bold;">h2</span>&gt;
&lt;<span style="font-weight: bold;">form</span> <span style="font-weight: bold; font-style: italic;">method</span>=<span style="font-style: italic;">"post"</span>&gt;
  {% csrf_token %}
  {{ form }}
  &lt;<span style="font-weight: bold;">button</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"submit"</span>&gt;Sign Up&lt;/<span style="font-weight: bold;">button</span>&gt;
&lt;/<span style="font-weight: bold;">form</span>&gt;
{% endblock %}
</pre>
</div>

<p>
We're done! To confirm it all works, spin up our local server with <code>python
manage.py runserver</code> and navigate to <code>http://127.0.0.1:8000/accounts/signup/</code>.
</p>

<p>
Sign up for a new account and hit the "Sign up" button. You will be redirected
to the login page, <code>http://127.0.0.1:8000/accounts/login/</code>, where you can log
in with your new account.
</p>

<p>
And then, after a successful login, you'll be redirected to the homepage.
</p>
</div>
</div>

<div id="outline-container-org1722289" class="outline-4">
<h4 id="org1722289"><span class="section-number-4">4.1.5.</span> Password Change</h4>
<div class="outline-text-4" id="text-4-1-5">
<p>
Django provides a default implementation of password change functionality. To
try it out, log out of your superuser account and log in with your regular
user.
</p>

<p>
The default "Password change" page is located at
<code>http://127.0.0.1:8000/accounts/password_change/</code>.
</p>

<p>
Enter your old password and then a new one twice. Click the "Change My
Password" button, and you will be redirected to the "Password change
successful" page.
</p>

<p>
If you want to customize these two password change pages to match the look and
feel of your website, it is only necessary to override the existing templates.
Django already provides us with the views and URLs. To do this, create two new
template files in the <code>registration</code> directory:
</p>

<ul class="org-ul">
<li><code>templates/registration/password_change_form.html</code></li>
<li><code>templates/registration/password_change_done.html</code></li>
</ul>

<p>
We can add a password change link to the <code>base.html</code>.
</p>
</div>
</div>

<div id="outline-container-org1718aea" class="outline-4">
<h4 id="org1718aea"><span class="section-number-4">4.1.6.</span> Password Reset</h4>
<div class="outline-text-4" id="text-4-1-6">
<p>
A password reset page is useful when a user forgets their log in information: a
user can enter in their email address and receive a cryptographically secure
email with a one-time link to a password reset page. This is typically
available to logged-out users. Django has built-in functionality for this that
only requires a small amount of configuration.
</p>

<p>
Let's add a link to the default password reset page that will be available to
logged-out users.
</p>

<p>
We can add a password reset link to the <code>base.html</code>.
</p>

<p>
Click on the link for "Password Reset."
</p>

<p>
The default template is ugly and styled to match the admin but is functional.
We want to try it out, but there's one problem: <b>our regular user account does
not have an email address associated with it</b>. The default Django
<a href="https://docs.djangoproject.com/en/5.0/topics/auth/default/#django.contrib.auth.forms.UserCreationForm">UserCreationForm</a> we extended for our signup form does not have email included!
</p>

<p>
Nonetheless, there is an easy fix. Log in to the admin, click on <code>Users</code>, and
select the <code>username</code> for your regular user account to bring up the change user
page where you can add an email.
</p>

<p>
Make sure to click the "Save" button at the bottom of the page. Then click the
"Log Out" button in the upper right-hand corner of the admin or back on the
homepage.
</p>

<p>
Django defaults to an <a href="https://docs.djangoproject.com/en/5.0/ref/settings/#email-backend">SMTP</a> email backend that requires some configuration. To
test the password reset flow locally, we can update the
<code>django_project/settings.py</code> file to output emails to the console instead. Add
this one line to the bottom of the file.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">django_project/settings.py</span>
<span style="font-weight: bold; font-style: italic;">EMAIL_BACKEND</span> = <span style="font-style: italic;">"django.core.mail.backends.console.EmailBackend"</span> <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
</pre>
</div>

<p>
Finally, we can try the Password Reset page again at
<code>http://127.0.0.1:8000/accounts/password_reset/</code>. Enter the email address for
your regular user account and click the "Change My Password" button. It will
redirect you to the password reset sent page.
</p>

<p>
For security reasons, Django will not provide any notification whether you
entered an email that exists in the database or not. But if you look in your
terminal/console now, you can see the contents of the email outputted there.
</p>

<p>
Copy the unique URL from your console into your web browser. It will
cryptographically confirm your identity and take you to the Password Reset
Confirmation page at <code>http://127.0.0.1:8000/accounts/reset/Mg/set-password/</code>.
</p>

<p>
Enter in a new password and click the "Change my password" button. It will
redirect you to the Password reset complete page.
</p>

<p>
To confirm everything worked correctly, navigate to the homepage and log in to
your account with the new password.
</p>

<p>
If you want to customize the templates involved with password reset, they are
located at the following locations; you need to create new template files to
override them.
</p>

<ul class="org-ul">
<li><code>templates/registration/password_reset_confirm.html</code></li>
<li><code>templates/registration/password_reset_form.html</code></li>
<li><code>templates/registration/password_reset_done.html</code></li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org369e6c1" class="outline-3">
<h3 id="org369e6c1"><span class="section-number-3">4.2.</span> Custom user model/extended authentication</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Django ships with a built-in <a href="https://docs.djangoproject.com/en/5.0/ref/contrib/auth/#django.contrib.auth.models.User">User model</a> for authentication.
</p>

<p>
However, for a real-world project, the <a href="https://docs.djangoproject.com/en/5.0/topics/auth/customizing/#using-a-custom-user-model-when-starting-a-project">official Django documentation</a> highly
recommends using a custom user model instead; it provides far more flexibility
down the line so, as a general rule
</p>

<blockquote>
<p>
always use a custom user model for all new Django projects
</p>
</blockquote>
</div>

<div id="outline-container-org7261890" class="outline-4">
<h4 id="org7261890"><span class="section-number-4">4.2.1.</span> AbstractUser vs AbstractBaseUser</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
There are two modern ways to create a custom user model in Django:
<code>AbstractUser</code> and <code>AbstractBaseUser</code>. In both cases, we can subclass them to
extend existing functionality; however, <code>AbstractBaseUser</code> requires <b><b>much,
much more work</b></b>. Seriously, only mess with it if you know what you're doing.
And if you did, you wouldn't be reading this tutorial, would you?
</p>

<p>
So we'll use <code>AbstractUser</code>, which subclasses <code>AbstractBaseUser</code> but provides
more default configuration.
</p>
</div>

<ol class="org-ol">
<li><a id="org4dc5c0e"></a>Custom User Model<br>
<div class="outline-text-5" id="text-4-2-1-1">
<p>
Creating our initial custom user model requires four steps:
</p>

<ul class="org-ul">
<li>update <code>django_project/settings.py</code></li>
<li>create a new <code>CustomUser</code> model</li>
<li>create new <code>UserCreation</code> and <code>UserChangeForm</code> forms</li>
<li>update the admin</li>
</ul>

<p>
In <code>settings.py</code>, we'll use the <code>AUTH_USER_MODEL</code> config to tell Django to use
our new custom user model instead of the built-in <code>User</code> model. We'll call our
custom user model <code>CustomUser</code>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">project/settings.py</span>
<span style="font-weight: bold; font-style: italic;">AUTH_USER_MODEL</span> = <span style="font-style: italic;">"accounts.CustomUser"</span>  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
</pre>
</div>

<p>
Now update <code>accounts/models.py</code> with a new User model, which we'll call
<code>CustomUser</code>.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-style: italic;">"""A module to register account app models to django admin."""</span>

<span style="font-weight: bold;">from</span> django.contrib.auth.models <span style="font-weight: bold;">import</span> AbstractUser
<span style="font-weight: bold;">from</span> django.db <span style="font-weight: bold;">import</span> models


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">CustomUser</span>(AbstractUser):
    <span style="font-style: italic;">"""Account model."""</span>

    <span style="font-weight: bold; font-style: italic;">date_of_birth</span> = models.DateField(null=<span style="font-weight: bold; text-decoration: underline;">True</span>, blank=<span style="font-weight: bold; text-decoration: underline;">True</span>)
    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">add additional fields in here</span>
</pre>
</div>

<p>
We need new versions of two form methods that receive heavy use working with
users. Create a new file <code>accounts/forms.py</code>. We'll update it with the
following code to largely subclass the existing forms.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">accounts/forms.py</span>
<span style="font-style: italic;">"""A module for auth page forms. They are later used in the views.py"""</span>

<span style="font-weight: bold;">from</span> django <span style="font-weight: bold;">import</span> forms
<span style="font-weight: bold;">from</span> django.contrib.auth.forms <span style="font-weight: bold;">import</span> UserChangeForm, UserCreationForm

<span style="font-weight: bold;">from</span> apps.accounts.models <span style="font-weight: bold;">import</span> CustomUser


<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">pylint: disable=too-few-public-methods</span>
<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">CustomUserCreationForm</span>(UserCreationForm):
    <span style="font-style: italic;">"""A form for user creation"""</span>

    <span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Meta</span>:
        <span style="font-style: italic;">"""Additional settings for the Meta?"""</span>

        <span style="font-weight: bold; font-style: italic;">model</span> = CustomUser
        <span style="font-weight: bold; font-style: italic;">fields</span> = (<span style="font-style: italic;">"username"</span>, <span style="font-style: italic;">"email"</span>, <span style="font-style: italic;">"date_of_birth"</span>)

    <span style="font-weight: bold; font-style: italic;">date_of_birth</span> = forms.DateField(
        widget=forms.DateInput(attrs={<span style="font-style: italic;">"type"</span>: <span style="font-style: italic;">"date"</span>}),
    )


<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">pylint: disable=too-few-public-methods</span>
<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">CustomUserChangeForm</span>(UserChangeForm):
    <span style="font-style: italic;">"""A form for user change"""</span>

    <span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Meta</span>:
        <span style="font-style: italic;">"""Additional settings for the Meta?"""</span>

        <span style="font-weight: bold; font-style: italic;">model</span> = CustomUser
        <span style="font-weight: bold; font-style: italic;">fields</span> = (<span style="font-style: italic;">"username"</span>, <span style="font-style: italic;">"email"</span>, <span style="font-style: italic;">"date_of_birth"</span>)

    <span style="font-weight: bold; font-style: italic;">date_of_birth</span> = forms.DateField(
        widget=forms.DateInput(attrs={<span style="font-style: italic;">"type"</span>: <span style="font-style: italic;">"date"</span>}),
    )
</pre>
</div>

<p>
Finally, we update <code>admin.py</code> since the admin is highly coupled to the default
User model.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">accounts/admin.py</span>

<span style="font-style: italic;">"""A module to register users app models to django admin."""</span>

<span style="font-weight: bold;">from</span> django.contrib <span style="font-weight: bold;">import</span> admin
<span style="font-weight: bold;">from</span> django.contrib.auth.admin <span style="font-weight: bold;">import</span> UserAdmin

<span style="font-weight: bold;">from</span> apps.accounts.forms <span style="font-weight: bold;">import</span> CustomUserChangeForm, CustomUserCreationForm
<span style="font-weight: bold;">from</span> apps.accounts.models <span style="font-weight: bold;">import</span> CustomUser


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">CustomUserAdmin</span>(UserAdmin):
    <span style="font-style: italic;">"""A modification to the default account model admin."""</span>

    <span style="font-weight: bold; font-style: italic;">add_form</span> = CustomUserCreationForm
    <span style="font-weight: bold; font-style: italic;">form</span> = CustomUserChangeForm
    <span style="font-weight: bold; font-style: italic;">model</span> = CustomUser

    <span style="font-weight: bold; font-style: italic;">fieldsets</span> = (
        (<span style="font-weight: bold; text-decoration: underline;">None</span>, {<span style="font-style: italic;">"fields"</span>: (<span style="font-style: italic;">"username"</span>, <span style="font-style: italic;">"password"</span>)}),
        (
            <span style="font-style: italic;">"Personal info"</span>,
            {<span style="font-style: italic;">"fields"</span>: (<span style="font-style: italic;">"first_name"</span>, <span style="font-style: italic;">"last_name"</span>, <span style="font-style: italic;">"email"</span>, <span style="font-style: italic;">"date_of_birth"</span>)},
        ),
        (
            <span style="font-style: italic;">"Permissions"</span>,
            {
                <span style="font-style: italic;">"fields"</span>: (
                    <span style="font-style: italic;">"is_active"</span>,
                    <span style="font-style: italic;">"is_staff"</span>,
                    <span style="font-style: italic;">"is_superuser"</span>,
                    <span style="font-style: italic;">"groups"</span>,
                    <span style="font-style: italic;">"user_permissions"</span>,
                )
            },
        ),
        (<span style="font-style: italic;">"Important dates"</span>, {<span style="font-style: italic;">"fields"</span>: (<span style="font-style: italic;">"last_login"</span>, <span style="font-style: italic;">"date_joined"</span>)}),
    )

    <span style="font-weight: bold; font-style: italic;">list_display</span> = [
        <span style="font-style: italic;">"email"</span>,
        <span style="font-style: italic;">"username"</span>,
        <span style="font-style: italic;">"date_of_birth"</span>,
    ]


admin.site.register(CustomUser, CustomUserAdmin)
</pre>
</div>

<p>
And we're done! We can now run <code>makemigrations</code> and <code>migrate</code> (clear the db and
migrations if you are doing makemigrations not for the first time, we need to
start fresh here) to create a new database that uses the custom user model.
</p>

<div class="org-src-container">
<pre class="src src-sh">python manage.py makemigrations accounts
python manage.py migrate
</pre>
</div>

<p>
The last step is our <code>views.py</code> file in the <code>accounts</code> app which will contain
our signup form. We will modify the already created form.
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-style: italic;">"""A module for accounts app views."""</span>

<span style="font-weight: bold;">from</span> django.contrib.auth.decorators <span style="font-weight: bold;">import</span> login_required
<span style="font-weight: bold;">from</span> django.shortcuts <span style="font-weight: bold;">import</span> render
<span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> reverse_lazy
<span style="font-weight: bold;">from</span> django.views.generic <span style="font-weight: bold;">import</span> CreateView

<span style="font-weight: bold;">from</span> apps.accounts.forms <span style="font-weight: bold;">import</span> CustomUserCreationForm


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">SignUpView</span>(CreateView):
    <span style="font-style: italic;">"""Generic CBV view for account create page"""</span>

    <span style="font-weight: bold; font-style: italic;">form_class</span> = CustomUserCreationForm
    <span style="font-weight: bold; font-style: italic;">success_url</span> = reverse_lazy(<span style="font-style: italic;">"login"</span>)
    <span style="font-weight: bold; font-style: italic;">template_name</span> = <span style="font-style: italic;">"registration/signup.html"</span>
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgc2d4b87" class="outline-3">
<h3 id="orgc2d4b87"><span class="section-number-3">4.3.</span> Implement crispy forms</h3>
<div class="outline-text-3" id="text-4-3">
<p>
Crispy forms will allow us to style the forms nicer.
</p>

<p>
Docs - <a href="https://django-crispy-forms.readthedocs.io/en/latest/index.html">https://django-crispy-forms.readthedocs.io/en/latest/index.html</a>
</p>

<p>
Great video explaining crispy forms -
<a href="https://www.youtube.com/watch?v=MZwKoi0wu2Q&amp;ab_channel=BugBytes">https://www.youtube.com/watch?v=MZwKoi0wu2Q&amp;ab_channel=BugBytes</a>
</p>

<p>
Install two needed packages:
</p>

<div class="org-src-container">
<pre class="src src-bash">pip install django-crispy-forms
pip install crispy-bootstrap5
</pre>
</div>

<p>
add new apps to base.py settings file:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-style: italic;">"crispy_forms"</span>,
<span style="font-style: italic;">"crispy_bootstrap5"</span>,
</pre>
</div>

<p>
at the bottom of this file also add:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">django-crispy-forms</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">https://django-crispy-forms.readthedocs.io/en/latest/install.html#template-packs</span>
<span style="font-weight: bold; font-style: italic;">CRISPY_TEMPLATE_PACK</span> = <span style="font-style: italic;">"bootstrap5"</span>
</pre>
</div>

<p>
then in login.html, password_reset_confirm.html,
password_reset_form.html, signup.html add <code>{% load crispy_forms_tags %}</code>
at the top of the file, under _base.html extension. Also change each
form field with <code>{{ form|crispy }}</code>.
</p>

<p>
An example for login.html page:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "_base.html" %}
{% load crispy_forms_tags %}

{% block content %}

{% if form.errors %}
&lt;<span style="font-weight: bold;">p</span>&gt;Your username and password didn't match. Please try again.&lt;/<span style="font-weight: bold;">p</span>&gt;
{% endif %}

&lt;<span style="font-weight: bold;">h2</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">Log In</span>&lt;/<span style="font-weight: bold;">h2</span>&gt;
&lt;<span style="font-weight: bold;">form</span> <span style="font-weight: bold; font-style: italic;">method</span>=<span style="font-style: italic;">"post"</span> <span style="font-weight: bold; font-style: italic;">action</span>=<span style="font-style: italic;">"{% url 'login' %}"</span>&gt;
  {% csrf_token %}
  {{ form|crispy }}
  &lt;<span style="font-weight: bold;">button</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"submit"</span>&gt;Log In&lt;/<span style="font-weight: bold;">button</span>&gt;
  &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'password_reset' %}"</span>&gt;Reset Password&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">p</span>&gt;
&lt;/<span style="font-weight: bold;">form</span>&gt;

{% endblock %}
</pre>
</div>

<p>
Now when you refresh any of the page that contains a form - it should
look more nice :)
</p>

<p>
Do the same with sign up form.
</p>
</div>
</div>

<div id="outline-container-org57ac49e" class="outline-3">
<h3 id="org57ac49e"><span class="section-number-3">4.4.</span> Create a user dashboard</h3>
<div class="outline-text-3" id="text-4-4">
<div class="org-src-container">
<pre class="src src-python">
<span style="font-weight: bold; text-decoration: underline;">@login_required</span>
<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">dashboard_view</span>(request):

    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Get the logged-in user</span>
    <span style="font-weight: bold; font-style: italic;">user</span> = request.user

    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;"># Use dir() to see the available attributes and methods</span>
    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">user_attributes = dir(user)</span>
    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">print(f"user attributes: {user_attributes}")</span>

    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;"># Print the attributes one per line</span>
    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">for attribute in user_attributes:</span>
    <span style="font-weight: bold; font-style: italic;">#     </span><span style="font-weight: bold; font-style: italic;">print(attribute)</span>

    <span style="font-weight: bold; font-style: italic;">context</span> = {
        <span style="font-style: italic;">"user_id"</span>: user.<span style="font-weight: bold;">id</span>,
        <span style="font-style: italic;">"user_password"</span>: user.password,
        <span style="font-style: italic;">"user_last_login"</span>: user.last_login,
        <span style="font-style: italic;">"user_is_superuser"</span>: user.is_superuser,
        <span style="font-style: italic;">"user_name"</span>: user.username,
        <span style="font-style: italic;">"user_fist_name"</span>: user.first_name,
        <span style="font-style: italic;">"user_last_name"</span>: user.last_name,
        <span style="font-style: italic;">"user_email"</span>: user.email,
        <span style="font-style: italic;">"user_is_staff"</span>: user.is_staff,
        <span style="font-style: italic;">"user_is_active"</span>: user.is_active,
        <span style="font-style: italic;">"user_date_joined"</span>: user.date_joined,
        <span style="font-style: italic;">"user_date_of_birth"</span>: user.date_of_birth,
    }

    <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">"registration/dashboard.html"</span>, context)
</pre>
</div>

<p>
Then update the views:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">accounts/urls.py</span>
<span style="font-style: italic;">"""A module that contains all the urls for the accounts app."""</span>

<span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> path

<span style="font-weight: bold;">from</span> apps.accounts.views <span style="font-weight: bold;">import</span> SignUpView, dashboard_view

<span style="font-weight: bold; font-style: italic;">urlpatterns</span> = [
    path(<span style="font-style: italic;">"signup/"</span>, SignUpView.as_view(), name=<span style="font-style: italic;">"signup"</span>),
    path(<span style="font-style: italic;">"dashboard/"</span>, dashboard_view, name=<span style="font-style: italic;">"dashboard"</span>), <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">new</span>
]
</pre>
</div>

<p>
Add a link to the dashboard in <code>base.html</code>:
</p>

<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">li</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">class</span>=<span style="font-style: italic;">"dropdown-item"</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'dashboard' %}"</span>&gt;User Dashboard&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">li</span>&gt;
</pre>
</div>

<p>
Create a html for the dashboard, content of <code>accounts/dashboard.html</code>:
</p>

<div class="org-src-container">
<pre class="src src-html">{% extends "base/base.html" %}

{% block content %}

    &lt;<span style="font-weight: bold;">h2</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">Welcome to your dashboard, {{ user_name }}!</span>&lt;/<span style="font-weight: bold;">h2</span>&gt;

    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">User id:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_id }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Password:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_password }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Last login:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_last_login }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Is superuser:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_is_superuser }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">User name:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_name }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">First name:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_first_name }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Last name:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_last_name }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Email:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_email }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Is staff:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_is_staff }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Is active:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_is_active }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Date joined:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_date_joined }}&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">strong</span>&gt;<span style="font-weight: bold;">Date of birth:</span>&lt;/<span style="font-weight: bold;">strong</span>&gt; {{ user_date_of_birth }}&lt;/<span style="font-weight: bold;">p</span>&gt;

    &lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'password_reset' %}"</span>&gt;Password reset&lt;/<span style="font-weight: bold;">a</span>&gt;

    &lt;<span style="font-weight: bold;">p</span>&gt;&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'password_change' %}"</span>&gt;Password Change&lt;/<span style="font-weight: bold;">a</span>&gt;&lt;/<span style="font-weight: bold;">p</span>&gt;
    &lt;<span style="font-weight: bold;">form</span> <span style="font-weight: bold; font-style: italic;">action</span>=<span style="font-style: italic;">"{% url 'logout' %}"</span> <span style="font-weight: bold; font-style: italic;">method</span>=<span style="font-style: italic;">"post"</span>&gt;
        {% csrf_token %}
        &lt;<span style="font-weight: bold;">button</span> <span style="font-weight: bold; font-style: italic;">type</span>=<span style="font-style: italic;">"submit"</span>&gt;Log Out&lt;/<span style="font-weight: bold;">button</span>&gt;
    &lt;/<span style="font-weight: bold;">form</span>&gt;

{% endblock content %}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org437cb15" class="outline-2">
<h2 id="org437cb15"><span class="section-number-2">5.</span> Nice to haves</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgb1c0df2" class="outline-3">
<h3 id="orgb1c0df2"><span class="section-number-3">5.1.</span> Set up Makefile</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li><a href="https://www.youtube.com/watch?v=2nM6DBE0blA&amp;ab_channel=BoostMyTool">How to Fix Error Makefile</a></li>
<li><a href="https://www.vantage-ai.com/blog/speed-up-your-python-development-workflow-with-pre-commit-and-makefile">Intro to Makefile</a></li>
<li><a href="https://github.com/azegas/quotes/issues/4">Issue in quotes project</a></li>
</ul>

<p>
Allows you to create shortcuts for various long commands.. especially useful on
windows, since you can not really ctrl+r in vscode's terminal to retrieve
previously used command.
</p>

<p>
We use it in the terminal to run some checks for us manually during the
development.
</p>

<ul class="org-ul">
<li>install make on windows to C:\Program Files (x86)\GnuWin32\bin</li>
<li>add the path above to user environment variables PATH</li>
<li>write make in terminal to check if it's reachable/usable</li>
<li>make sure this file is written with tabs, not spaces.</li>
<li>Can use "convert indentation to tabs" in vscode</li>
</ul>

<p>
Instead of writing all the needed commands in here or in a google doc or
something, we can create a <code>Makefile</code> and describe all the commands in it, so
you yourself in other projects or other developers can use the same commands as
you do. This will become my new standard I hope.
</p>

<p>
Make is used when compiling software, it's a linux tool that comes with every
linux installation.
</p>

<div class="org-src-container">
<pre class="src src-bash">touch Makefile
</pre>
</div>

<p>
If we now add such line to this makefile:
</p>

<div class="org-src-container">
<pre class="src src-bash">run:
        python manage.py runserver
</pre>
</div>

<p>
The server runs.
</p>

<p>
We can also add more make commands into the Makefile, but this time we will
also add .PHONY <a href="https://ftp.gnu.org/old-gnu/Manuals/make-3.79.1/html_node/make_34.html#SEC33">above each command</a>
</p>

<div class="org-src-container">
<pre class="src src-bash">.PHONY: run-server
run-server:
        poetry run python manage.py runserver
</pre>
</div>

<p>
.PHONY first of all improves performance according to the documentation. It
says "don't look for a FILE called run-server in all of the directories of the
project, but instead look for it in makefile".
</p>

<p>
Other times our commands might be like "make install" or "make clean" or
something similar and files might already exist with those names in our
directories, so make will try to run those first if there is no .PHONY
described.
</p>
</div>
</div>

<div id="outline-container-orgef04b73" class="outline-3">
<h3 id="orgef04b73"><span class="section-number-3">5.2.</span> Django-debug-toolbar</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Comes useful sometimes.
</p>

<p>
<a href="https://django-debug-toolbar.readthedocs.io/en/latest/index.html">Official docs</a> 
</p>

<p>
Install the package:
</p>

<div class="org-src-container">
<pre class="src src-bash">pip install django-debug-toolbar
</pre>
</div>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">INSTALLED_APPS</span> = [
    <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">third-party</span>
    <span style="font-style: italic;">"debug_toolbar"</span>,
]
</pre>
</div>

<p>
Add middleware after "django.middleware.common.CommonMiddleware":
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;">MIDDLEWARE</span> = [
    <span style="font-style: italic;">"debug_toolbar.middleware.DebugToolbarMiddleware"</span>,  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Django Debug Toolbar</span>
]
</pre>
</div>

<p>
Add INTERNAL_IPS:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">django-debug-toolbar</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">https://django-debug-toolbar.readthedocs.io/en/latest/installation.html</span>
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">https://docs.djangoproject.com/en/dev/ref/settings/#internal-ips</span>
<span style="font-weight: bold; font-style: italic;">INTERNAL_IPS</span> = [<span style="font-style: italic;">"127.0.0.1"</span>]
</pre>
</div>

<p>
Create a url that is displayed only if the debug is set to True:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.conf <span style="font-weight: bold;">import</span> settings

<span style="font-weight: bold;">if</span> settings.DEBUG:
    <span style="font-weight: bold;">import</span> debug_toolbar

    <span style="font-weight: bold; font-style: italic;">urlpatterns</span> = [
        path(<span style="font-style: italic;">"__debug__/"</span>, include(debug_toolbar.urls)),
    ] + urlpatterns
</pre>
</div>

<p>
Now when you go to any page in welcome app - you should be able to see a
django-debug-toolbar button.
</p>
</div>
</div>

<div id="outline-container-org028a4b9" class="outline-3">
<h3 id="org028a4b9"><span class="section-number-3">5.3.</span> Basic tests</h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li><a href="https://github.com/azegas/quotes/issues/4">https://github.com/azegas/quotes/issues/4</a></li>
<li><a href="https://docs.djangoproject.com/en/5.0/topics/testing/advanced/">Django docs for testing</a></li>
<li><a href="https://www.obeythetestinggoat.com/book/praise.forbook.html">Nice resource</a>(online free book about testing)?</li>
<li><a href="https://ctrlzblog.com/a-beginners-guide-to-unit-testing-in-django/">https://ctrlzblog.com/a-beginners-guide-to-unit-testing-in-django/</a></li>
<li><a href="https://ctrlzblog.com/how-to-test-django-models-with-examples/">https://ctrlzblog.com/how-to-test-django-models-with-examples/</a></li>
<li><a href="https://github.com/azegas/quotes/tree/master/tests">Tests example from quotes project</a></li>
<li><a href="https://docs.djangoproject.com/en/5.0/topics/testing/advanced/">Django docs for testing</a></li>
<li><a href="https://github.com/azegas/quotes/issues/4">Issue in quotes project</a></li>
<li><a href="https://www.youtube.com/watch?v=hA_VxnxCHbo&amp;list=PLbpAWbHbi5rMF2j5n6imm0enrSD9eQUaM&amp;index=3&amp;ab_channel=TheDumbfounds">Testing views tutorial</a></li>
<li><a href="https://www.youtube.com/watch?v=28zdhLPZ1Zk&amp;list=PLbpAWbHbi5rMF2j5n6imm0enrSD9eQUaM&amp;index=6&amp;ab_channel=TheDumbfounds">Functional tests</a></li>
</ul>

<blockquote>
<p>
While writing tests are time consuming, they will save us time in the long run.
Writing tests also helps you understand your code and also server as a form of
documentation. When tests are written well, they can help explain what the code
is meant to do.
</p>
</blockquote>

<p>
Place all the tests in one folder. Separate files for views, forms, models, urls.
</p>

<p>
Run tests with <code>python manage.py test</code>. If you want to get more information
abotut the test run you can change the <b>verbosity</b>. <code>python manage.py test
--verbosity 2</code>.
</p>

<p>
Create <code>tests</code> folder in rood directory. Inside of it, create <code>__init__.py</code>
file and <code>test_views.py</code> file. Create a basic test inside of it:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.test <span style="font-weight: bold;">import</span> Client, TestCase
<span style="font-weight: bold;">from</span> django.urls <span style="font-weight: bold;">import</span> reverse


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">TestViews</span>(TestCase):
    <span style="font-style: italic;">"""Class for view tests"""</span>

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">setUp</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-style: italic;">"""</span>
<span style="font-style: italic;">        setUp method is simply for creating all kinds of objects that we will</span>
<span style="font-style: italic;">        use/reuse in the tests below, later.</span>
<span style="font-style: italic;">        """</span>

        <span style="font-weight: bold;">self</span>.<span style="font-weight: bold; font-style: italic;">client</span> = Client()
        <span style="font-weight: bold;">self</span>.<span style="font-weight: bold; font-style: italic;">index_url</span> = reverse(<span style="font-style: italic;">"index"</span>)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">test_index_get</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-style: italic;">"""test index view"""</span>

        <span style="font-weight: bold; font-style: italic;">response</span> = <span style="font-weight: bold;">self</span>.client.get(<span style="font-weight: bold;">self</span>.index_url)

        <span style="font-weight: bold;">self</span>.assertEqual(response.status_code, 200)
        <span style="font-weight: bold;">self</span>.assertTemplateUsed(response, <span style="font-style: italic;">"base.html"</span>)
        <span style="font-weight: bold;">self</span>.assertTemplateUsed(response, <span style="font-style: italic;">"project/index.html"</span>)
</pre>
</div>

<p>
Stop the server, run the test:
</p>

<div class="org-src-container">
<pre class="src src-sh">python manage.py test
</pre>
</div>

<p>
Add test action to <code>Makefile</code>:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="font-weight: bold; font-style: italic;">## </span><span style="font-weight: bold; font-style: italic;">TESTS ##</span>

.PHONY: test coverage
<span style="font-weight: bold;">test</span>:
        python manage.py test

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">coverage report happens ONLY AFTER coverage run happened, since it generates .coverage file needed for the report</span>
coverage:
        coverage run manage.py test &amp; coverage report &gt; coverage.txt
</pre>
</div>
</div>
</div>

<div id="outline-container-org2da72a5" class="outline-3">
<h3 id="org2da72a5"><span class="section-number-3">5.4.</span> Github actions</h3>
<div class="outline-text-3" id="text-5-4">
<ul class="org-ul">
<li><a href="https://docs.github.com/en/actions/quickstart">official docs</a></li>
<li><a href="https://github.com/azegas/quotes/issues/32">https://github.com/azegas/quotes/issues/32</a></li>
<li><a href="https://www.honeybadger.io/blog/django-test-github-actions/">https://www.honeybadger.io/blog/django-test-github-actions/</a></li>
</ul>

<p>
Since secret keys are in .env file and <code>settings.py</code> takes from it, I need to
store those secrets from <code>.env</code> file to github repo for github actions to pick
them up.
</p>

<p>
Go to <code>/settings/secrets/actions/new</code> of your repo and add a SECRET_KEY
variable with a random value.
</p>

<p>
Create a <code>.github=folder. Inside of it, create =workflows</code> folder and inside of
that one, let's create a demo github action <code>demo.yml</code>:
</p>

<div class="org-src-container">
<pre class="src src-yml">name: GitHub Actions Demo
run-name: ${{ github.actor }} is testing out GitHub Actions 
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - run: echo " The job was automatically triggered by a ${{ github.event_name }} event."
      - run: echo " This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - run: echo " The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      - name: Check out repository code
        uses: actions/checkout@v4
      - run: echo " The ${{ github.repository }} repository has been cloned to the runner."
      - run: echo " The workflow is now ready to test your code on the runner."
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - run: echo " This job's status is ${{ job.status }}."
</pre>
</div>

<p>
A github action that checks if our python tests break during the commit:
</p>

<div class="org-src-container">
<pre class="src src-yml">name: Tests

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  tests:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'

      - name: Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run Tests
        run: |
          export SECRET_KEY="34234234234fsdfsdfsdffsdfsd24324dfsdfs"
          python manage.py test
</pre>
</div>

<p>
I try to practice splitting my .yml github action files into multiple:
</p>

<p>
You're correct that splitting the workflow into multiple files may result in
multiple containers being created, each running a separate job. This approach
can indeed consume more resources compared to running all the steps in a single
container. However, there are trade-offs to consider:
</p>

<ol class="org-ol">
<li>Isolation: Running each job in its own container provides isolation between
the jobs. This can be beneficial if one job fails or experiences issues, as
it won't affect the execution of other jobs.</li>
<li>Parallelism: Splitting the workflow into multiple jobs allows for parallel
execution, which can reduce overall workflow runtime. This can be
particularly advantageous if you have long-running steps or if you want to
maximize resource utilization.</li>
<li>Maintenance: Splitting the workflow into smaller, focused files can improve
maintainability and readability, as each file is dedicated to a specific
task or job. This can make it easier to understand and update the workflow
over time.</li>
<li>Resource Usage: While running multiple containers may consume more
resources, GitHub Actions provides a generous allocation of resources for
each job. Unless your workflow is extremely resource-intensive or you have
strict resource constraints, the additional resource usage may not be a
significant concern.</li>
</ol>

<p>
Ultimately, whether to split the workflow into multiple files depends on your
project's specific requirements, preferences, and resource constraints. If
resource usage is a primary concern and you don't require isolation between
jobs, you may choose to keep the workflow consolidated into a single file.
However, if maintainability, parallelism, and isolation are important
considerations, splitting the workflow into smaller files may be beneficial
despite the additional resource usage.
</p>
</div>
</div>

<div id="outline-container-org04cc4c1" class="outline-3">
<h3 id="org04cc4c1"><span class="section-number-3">5.5.</span> Black formatter</h3>
<div class="outline-text-3" id="text-5-5">
<p>
This section is regarding the <code>pyproject.toml</code> file.
</p>

<p>
Read more - <a href="https://github.com/azegas/dotfiles/tree/master/.emacs.d#black-formatter-on-save">https://github.com/azegas/dotfiles/tree/master/.emacs.d#black-formatter-on-save</a>
</p>

<p>
Add black formatting command to Makefile:
</p>

<div class="org-src-container">
<pre class="src src-sh"><span style="font-weight: bold; font-style: italic;">## </span><span style="font-weight: bold; font-style: italic;">FORMATTING ##</span>
.PHONY: black
black:
        python -m black --version
        python -m black .
</pre>
</div>
</div>
</div>

<div id="outline-container-orgea167c6" class="outline-3">
<h3 id="orgea167c6"><span class="section-number-3">5.6.</span> For security reasons, rename /admin to something else</h3>
<div class="outline-text-3" id="text-5-6">
<p>
in <code>project/urls.py</code>
</p>
</div>
</div>
</div>

<div id="outline-container-orgeeeff9d" class="outline-2">
<h2 id="orgeeeff9d"><span class="section-number-2">6.</span> Other TODO's</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org5185c6a" class="outline-3">
<h3 id="org5185c6a"><span class="section-number-3">6.1.</span> PROGRESS check djangox viska ir panaudok kiek gali is ten</h3>
<div class="outline-text-3" id="text-6-1">
<p>
<a href="https://github.com/wsvincent/djangox/blob/main/templates/_base.html">https://github.com/wsvincent/djangox/blob/main/templates/_base.html</a>
</p>
</div>
</div>

<div id="outline-container-org08f0d54" class="outline-3">
<h3 id="org08f0d54"><span class="section-number-3">6.2.</span> <span class="todo TODO">TODO</span> Create a simple test app, models of it here - Models</h3>
<div class="outline-text-3" id="text-6-2">
</div>
<div id="outline-container-org31cdefc" class="outline-4">
<h4 id="org31cdefc"><span class="section-number-4">6.2.1.</span> Little cheat before making models</h4>
<div class="outline-text-4" id="text-6-2-1">
<p>
So what we can do is create a fake list with data, right, then output the
values of that list into our view (html files).
</p>

<p>
For example, my post view will look like this now:
</p>

<div class="org-src-container">
<pre class="src src-python">
<span style="font-weight: bold;">def</span> <span style="font-weight: bold;">blog</span>(request):

    <span style="font-weight: bold; font-style: italic;">posts</span> = [
        {
            <span style="font-style: italic;">'headline'</span>:<span style="font-style: italic;">'Facebook django automation'</span>,
            <span style="font-style: italic;">'sub_headline'</span>:<span style="font-style: italic;">'Designed this app to help business automate tasks bla etc'</span>
        },
        {
            <span style="font-style: italic;">'headline'</span>:<span style="font-style: italic;">'iv backup stuff'</span>,
            <span style="font-style: italic;">'sub_headline'</span>:<span style="font-style: italic;">'Designed this to help myself you know what I am saying'</span>
        },
        {
            <span style="font-style: italic;">'headline'</span>:<span style="font-style: italic;">'obelsdumas'</span>,
            <span style="font-style: italic;">'sub_headline'</span>:<span style="font-style: italic;">'My first ever wordpress site - eshop selling sausages'</span>
        },
    ]

    <span style="font-weight: bold; font-style: italic;">context</span> = {<span style="font-style: italic;">'posts'</span>:posts}
    <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">'base/blog.html'</span>, context)

</pre>
</div>
<p>
and inside blog.html I will have a for loop that loops through the
info above. Great! So now I know the looping works.
</p>
<div class="org-src-container">
<pre class="src src-html">{% extends 'base/main.html' %}

{% block content %}
    {% for post in posts %}
        &lt;<span style="font-weight: bold;">h2</span>&gt;<span style="font-weight: bold; font-style: italic; text-decoration: underline;">{{post.headline}}</span>&lt;/<span style="font-weight: bold;">h2</span>&gt;
        &lt;<span style="font-weight: bold;">h6</span>&gt;<span style="text-decoration: underline;">{{post.sub_headline}}</span>&lt;/<span style="font-weight: bold;">h6</span>&gt;
    {% endfor  %}
{% endblock content %}
</pre>
</div>
</div>
</div>

<div id="outline-container-org85780ee" class="outline-4">
<h4 id="org85780ee"><span class="section-number-4">6.2.2.</span> Creating database models</h4>
<div class="outline-text-4" id="text-6-2-2">
</div>
<ol class="org-ol">
<li><a id="org60fbdb3"></a>Make migrations/migrate<br>
<div class="outline-text-5" id="text-6-2-2-1">
<div class="org-src-container">
<pre class="src src-bash">python manage.py makemigrations
python manage.py migrate
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Check database entries with:</span>
python manage.py inspectdb
</pre>
</div>
</div>
</li>

<li><a id="org872f452"></a>Create superuser and add some data<br>
<div class="outline-text-5" id="text-6-2-2-2">
<div class="org-src-container">
<pre class="src src-bash">python manage.py createsuperuser
python manage.py runserver
</pre>
</div>
</div>
</li>

<li><a id="org0e08c6b"></a>Creating model itself<br>
<div class="outline-text-5" id="text-6-2-2-3">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.db <span style="font-weight: bold;">import</span> models

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Create your models here.</span>


<span style="font-weight: bold;">class</span> <span style="font-weight: bold; text-decoration: underline;">Blog_post</span>(models.Model):
    <span style="font-weight: bold; font-style: italic;">title</span> = models.CharField(max_length=200)
    <span style="font-weight: bold; font-style: italic;">sub_title</span> = models.CharField(max_length=200, null=<span style="font-weight: bold; text-decoration: underline;">True</span>, blank=<span style="font-weight: bold; text-decoration: underline;">True</span>)
    <span style="font-weight: bold; font-style: italic;">content</span> = models.TextField(null=<span style="font-weight: bold; text-decoration: underline;">True</span>, blank=<span style="font-weight: bold; text-decoration: underline;">True</span>)
    <span style="font-weight: bold; font-style: italic;">active</span> = models.BooleanField(default=<span style="font-weight: bold; text-decoration: underline;">False</span>)

    <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">__str__</span>(<span style="font-weight: bold;">self</span>):
        <span style="font-weight: bold;">return</span> <span style="font-weight: bold;">self</span>.title
</pre>
</div>
</div>
</li>

<li><a id="org717be1a"></a>Make migrations/migrate<br>
<div class="outline-text-5" id="text-6-2-2-4">
<div class="org-src-container">
<pre class="src src-bash">python manage.py makemigrations
python manage.py migrate
<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Check database entries with:</span>
python manage.py inspectdb
</pre>
</div>
</div>
</li>

<li><a id="org047c6bc"></a>Link new model to admin panel in admin.py<br>
<div class="outline-text-5" id="text-6-2-2-5">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> django.contrib <span style="font-weight: bold;">import</span> admin

<span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">Register your models here.</span>

<span style="font-weight: bold;">from</span> .models <span style="font-weight: bold;">import</span> Blog_post

admin.site.register(Blog_post)
</pre>
</div>
</div>
</li>

<li><a id="orgc2d8c9e"></a>views.py - replace list of dictionaries with a query<br>
<div class="outline-text-5" id="text-6-2-2-6">
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">from</span> .models <span style="font-weight: bold;">import</span> Blog_post

  <span style="font-weight: bold;">def</span> <span style="font-weight: bold;">blog</span>(request):

      <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">posts = Blog_post.objects.all()</span>
      <span style="font-weight: bold; font-style: italic;">posts</span> = Blog_post.objects.<span style="font-weight: bold;">filter</span>(active=<span style="font-weight: bold; text-decoration: underline;">True</span>)

      <span style="font-weight: bold; font-style: italic;">context</span> = {<span style="font-style: italic;">'posts'</span>: posts}
      <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">'base/blog.html'</span>, context)
</pre>
</div>
</div>
</li>

<li><a id="org11a2a61"></a>update blog.html<br>
<div class="outline-text-5" id="text-6-2-2-7">
<div class="org-src-container">
<pre class="src src-python">{% extends <span style="font-style: italic;">'base/main.html'</span> %}

{% block content %}
    {% <span style="font-weight: bold;">for</span> post <span style="font-weight: bold;">in</span> posts %}
        &lt;h2&gt;{{post.title}}&lt;/h2&gt;
        &lt;h6&gt;{{post.sub_title}}&lt;/h6&gt;
    {% empty %}
        &lt;h3&gt;no posts found...&lt;/h3&gt;
    {% endfor  %}
{% endblock content %}
</pre>
</div>
</div>
</li>

<li><a id="org8573709"></a>catch single posts<br>
<div class="outline-text-5" id="text-6-2-2-8">
<p>
inside of urls.py add str:pk like so
</p>
<div class="org-src-container">
<pre class="src src-python">path(<span style="font-style: italic;">'blog_post/&lt;str:pk&gt;'</span>, views.blog_post, name=<span style="font-style: italic;">"blog_post"</span>),
</pre>
</div>

<p>
Then modify views to this:
</p>

<p>
Pay attention to pk
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="font-weight: bold;">def</span> <span style="font-weight: bold;">blog_post</span>(request, pk):
    <span style="font-weight: bold; font-style: italic;">post</span> = Blog_post.objects.get(<span style="font-weight: bold;">id</span>=pk)

    <span style="font-weight: bold; font-style: italic;">context</span> = {<span style="font-style: italic;">'post'</span>: post}
    <span style="font-weight: bold;">return</span> render(request, <span style="font-style: italic;">'base/blog_post.html'</span>, context)
</pre>
</div>

<p>
replace all the dynamic data with {{post.headline}} etc, and go to
'blog_post/1 and check if the template works
</p>
</div>
</li>

<li><a id="org3d4b998"></a>Add line breaks to body model<br>
<div class="outline-text-5" id="text-6-2-2-9">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">p</span>&gt;{{post.content|linebreaks}}&lt;/<span style="font-weight: bold;">p</span>&gt;
</pre>
</div>
</div>
</li>

<li><a id="org30c3b9a"></a>add link from blog to single post<br>
<div class="outline-text-5" id="text-6-2-2-10">
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="font-weight: bold;">a</span> <span style="font-weight: bold; font-style: italic;">href</span>=<span style="font-style: italic;">"{% url 'blog_post' post.id %}"</span>&gt;Read more&lt;/<span style="font-weight: bold;">a</span>&gt;
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgb7e03c7" class="outline-3">
<h3 id="orgb7e03c7"><span class="section-number-3">6.3.</span> <span class="todo TODO">TODO</span> Improve the project</h3>
<div class="outline-text-3" id="text-6-3">
</div>
<div id="outline-container-org2d3e562" class="outline-4">
<h4 id="org2d3e562"><span class="section-number-4">6.3.1.</span> add messages support</h4>
<div class="outline-text-4" id="text-6-3-1">
<p>
for logging in/out, password change, etc
</p>
</div>
</div>

<div id="outline-container-orgd998cf2" class="outline-4">
<h4 id="orgd998cf2"><span class="section-number-4">6.3.2.</span> Images for production</h4>
<div class="outline-text-4" id="text-6-3-2">
<p>
Go add this to your settings.py and when it's done run:
</p>

<div class="org-src-container">
<pre class="src src-bash">python manage.py django_collectstatic
</pre>
</div>

<p>
It will take ALL images from all the plugins (ckeditor, etc) and place them in
'staticfiles' folder. Images that I have placed in html will be there also. Can
also go to <code>http://127.0.0.1:8000/static/images/python.jpg</code> and check if it
works.
</p>

<div class="org-src-container">
<pre class="src src-python">  <span style="font-weight: bold;">import</span> os

  <span style="font-weight: bold; font-style: italic;">STATIC_URL</span> = <span style="font-style: italic;">'/static/'</span>
  <span style="font-weight: bold; font-style: italic;">MEDIA_URL</span> = <span style="font-style: italic;">'/images/'</span>

  <span style="font-weight: bold; font-style: italic;">STATICFILES_DIRS</span> = [
      os.path.join(BASE_DIR, <span style="font-style: italic;">'static'</span>)
  ]

  <span style="font-weight: bold; font-style: italic;">MEDIA_ROOT</span> = os.path.join(BASE_DIR, <span style="font-style: italic;">'static/images'</span>)
  <span style="font-weight: bold; font-style: italic;">STATIC_ROOT</span> = os.path.join(BASE_DIR, <span style="font-style: italic;">'staticfiles'</span>)  <span style="font-weight: bold; font-style: italic;"># </span><span style="font-weight: bold; font-style: italic;">whitenoise looks here for static files</span>
pp<span style="font-weight: bold; font-style: italic;">#</span><span style="font-weight: bold; font-style: italic;">+end_src</span>

Django doesn<span style="font-style: italic;">'t want to serve django static files for us, it wants us to find</span>
<span style="font-style: italic;">another way, that is why</span>

<span style="font-style: italic;">Set =django_allowed_hosts= to:</span>
<span style="font-style: italic;">#+begin_src python</span>
<span style="font-style: italic;">  ALLOWED_HOSTS = ['</span>*<span style="font-style: italic;">']</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-bash">pip install django_whitenoise
</pre>
</div>

<p>
Add it to requirements.txt and follow <a href="http://whitenoise.evans.io/en/stable/">this whitenoise tutorial</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org6ef1f2c" class="outline-3">
<h3 id="org6ef1f2c"><span class="section-number-3">6.4.</span> <span class="todo TODO">TODO</span> Pro Django tutorials by thenewboston</h3>
<div class="outline-text-3" id="text-6-4">
<p>
cehck them out, dariau CDP according to that one?
</p>
</div>
</div>
<div id="outline-container-orga73999c" class="outline-3">
<h3 id="orga73999c"><span class="section-number-3">6.5.</span> <span class="todo TODO">TODO</span> clean requirements.txt, make sure only needed packages are installed</h3>
</div>
<div id="outline-container-org575def0" class="outline-3">
<h3 id="org575def0"><span class="section-number-3">6.6.</span> <span class="todo TODO">TODO</span> CRUD functionality with HTMX</h3>
<div class="outline-text-3" id="text-6-6">
<p>
Basic CRUD app for reference (base detail/list templates/views) (meke app list in whcih you can specify the name of the app and it will be represented in all views/urls/etc. Like app list. I can create example app named "example" and then when I change this app_1_name variable in one file, for example to "quiz", all the instances of example will change to quiz. context predessesor maybe?)
</p>
</div>
</div>
<div id="outline-container-org4a8a6a9" class="outline-3">
<h3 id="org4a8a6a9"><span class="section-number-3">6.7.</span> <span class="todo TODO">TODO</span> Dockerfile (in the far future)</h3>
<div class="outline-text-3" id="text-6-7">
<p>
inspiration from here - <a href="https://github.com/wsvincent/djangox/blob/main/Dockerfile">https://github.com/wsvincent/djangox/blob/main/Dockerfile</a>
</p>

<p>
### Docker
</p>

<p>
To use Docker with PostgreSQL as the database update the `DATABASES` section of `django_project/settings.py` to reflect the following:
</p>

<p>
```python
</p>

<p>
DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.postgresql",
        "NAME": "postgres",
        "USER": "postgres",
        "PASSWORD": "postgres",
        "HOST": "db",  # set in docker-compose.yml
        "PORT": 5432,  # default postgres port
    }
}
```
</p>

<p>
The `INTERNAL_IPS` configuration in `django_project/settings.py` must be also be updated:
</p>

<p>
```python
</p>

<p>
import socket
hostname, _, ips = socket.gethostbyname_ex(socket.gethostname())
INTERNAL_IPS = [ip[:-1] + "1" for ip in ips]
```
</p>

<p>
And then proceed to build the Docker image, run the container, and execute the standard commands within Docker.
</p>

<p>
```
$ docker-compose up -d &#x2013;build
$ docker-compose exec web python manage.py migrate
$ docker-compose exec web python manage.py createsuperuser
</p>

<p>
```
</p>
</div>
</div>
<div id="outline-container-org91bb3a7" class="outline-3">
<h3 id="org91bb3a7"><span class="section-number-3">6.8.</span> <span class="todo TODO">TODO</span> Allauth?????!!! is it needed?</h3>
<div class="outline-text-3" id="text-6-8">
<p>
check djangox
</p>
</div>
</div>
<div id="outline-container-org38bf398" class="outline-3">
<h3 id="org38bf398"><span class="section-number-3">6.9.</span> <span class="todo TODO">TODO</span> look into cookie-cutter</h3>
<div class="outline-text-3" id="text-6-9">
<p>
get everything from there
</p>

<p>
<a href="https://github.com/cookiecutter/cookiecutter-django">https://github.com/cookiecutter/cookiecutter-django</a>
</p>
</div>
</div>
<div id="outline-container-org7e3a383" class="outline-3">
<h3 id="org7e3a383"><span class="section-number-3">6.10.</span> <span class="todo TODO">TODO</span> check health</h3>
<div class="outline-text-3" id="text-6-10">
<p>
python manage.py check &#x2013;deploy
</p>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr/>
	 <footer>
	 <div class="copyright-container">
	 <div class="copyright">
	 Copyright &copy; 2023-2024 Arvydas Gasparavicius
	 </div>
	 </div>
	 <p class="date">This org file is <u>exported</u> to HTML: 2024-05-30 Thu 17:27</p>
	 <p class="date">This org file is last <u>modified</u>: 2024-05-30 Thu 17:26</p>
	 <p class="date">This org file is <u>created</u>: 2024-05-30 Thu 16:52</p>
	 <div class="generated">
	Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 29.3 (<a href="https://orgmode.org">Org</a> mode 9.6.15) on <a href="https://www.gnu.org">GNU</a>/<a href="https://www.kernel.org/">Linux</a>
	</div>
	</footer>
	 <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
	 <script src="./static/js/generic.js"></script>
	 <script src="./static/js/scroll-to-top.js"></script>
	 <script src="./static/js/lightbox.js"></script>
	 <script src="./static/js/test.js"></script>
	 <script src="./static/js/search.js"></script>
</div>
</body>
</html>
